
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../commands/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>API reference - agptools</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="agptools" class="md-header__button md-logo" aria-label="agptools" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            agptools
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="agptools" class="md-nav__button md-logo" aria-label="agptools" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    agptools
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Commands
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    API reference
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    API reference
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#agp" class="md-nav__link">
    <span class="md-ellipsis">
      agp
    </span>
  </a>
  
    <nav class="md-nav" aria-label="agp">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.AgpFormatError" class="md-nav__link">
    <span class="md-ellipsis">
      AgpFormatError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow" class="md-nav__link">
    <span class="md-ellipsis">
      AgpRow
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AgpRow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.component_beg" class="md-nav__link">
    <span class="md-ellipsis">
      component_beg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.component_end" class="md-nav__link">
    <span class="md-ellipsis">
      component_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.component_id" class="md-nav__link">
    <span class="md-ellipsis">
      component_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.component_type" class="md-nav__link">
    <span class="md-ellipsis">
      component_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.gap_length" class="md-nav__link">
    <span class="md-ellipsis">
      gap_length
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.gap_type" class="md-nav__link">
    <span class="md-ellipsis">
      gap_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.is_gap" class="md-nav__link">
    <span class="md-ellipsis">
      is_gap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.linkage" class="md-nav__link">
    <span class="md-ellipsis">
      linkage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.linkage_evidence" class="md-nav__link">
    <span class="md-ellipsis">
      linkage_evidence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.object" class="md-nav__link">
    <span class="md-ellipsis">
      object
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.object_beg" class="md-nav__link">
    <span class="md-ellipsis">
      object_beg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.object_end" class="md-nav__link">
    <span class="md-ellipsis">
      object_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.orientation" class="md-nav__link">
    <span class="md-ellipsis">
      orientation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.part_number" class="md-nav__link">
    <span class="md-ellipsis">
      part_number
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.contains" class="md-nav__link">
    <span class="md-ellipsis">
      contains
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.is_string" class="md-nav__link">
    <span class="md-ellipsis">
      is_string
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.open_agp" class="md-nav__link">
    <span class="md-ellipsis">
      open_agp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.read" class="md-nav__link">
    <span class="md-ellipsis">
      read
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agp.assemble" class="md-nav__link">
    <span class="md-ellipsis">
      assemble
    </span>
  </a>
  
    <nav class="md-nav" aria-label="assemble">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.assemble.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agp.bed" class="md-nav__link">
    <span class="md-ellipsis">
      bed
    </span>
  </a>
  
    <nav class="md-nav" aria-label="bed">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.bed.BadRangeError" class="md-nav__link">
    <span class="md-ellipsis">
      BadRangeError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.bed.BedRange" class="md-nav__link">
    <span class="md-ellipsis">
      BedRange
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BedRange">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.bed.BedRange.chrom" class="md-nav__link">
    <span class="md-ellipsis">
      chrom
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.bed.BedRange.end" class="md-nav__link">
    <span class="md-ellipsis">
      end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.bed.BedRange.extra_fields" class="md-nav__link">
    <span class="md-ellipsis">
      extra_fields
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.bed.BedRange.start" class="md-nav__link">
    <span class="md-ellipsis">
      start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.bed.BedRange.strand" class="md-nav__link">
    <span class="md-ellipsis">
      strand
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.bed.EmptyRangeError" class="md-nav__link">
    <span class="md-ellipsis">
      EmptyRangeError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.bed.ParsingError" class="md-nav__link">
    <span class="md-ellipsis">
      ParsingError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.bed.open_bed" class="md-nav__link">
    <span class="md-ellipsis">
      open_bed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.bed.read" class="md-nav__link">
    <span class="md-ellipsis">
      read
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agp.flip" class="md-nav__link">
    <span class="md-ellipsis">
      flip
    </span>
  </a>
  
    <nav class="md-nav" aria-label="flip">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.flip.flip" class="md-nav__link">
    <span class="md-ellipsis">
      flip
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.flip.reverse_rows" class="md-nav__link">
    <span class="md-ellipsis">
      reverse_rows
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agp.join" class="md-nav__link">
    <span class="md-ellipsis">
      join
    </span>
  </a>
  
    <nav class="md-nav" aria-label="join">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.join.BadSequenceNameError" class="md-nav__link">
    <span class="md-ellipsis">
      BadSequenceNameError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.join.JoinGroup" class="md-nav__link">
    <span class="md-ellipsis">
      JoinGroup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.join.ScaffoldNotFoundError" class="md-nav__link">
    <span class="md-ellipsis">
      ScaffoldNotFoundError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.join.ScaffoldUsedTwiceError" class="md-nav__link">
    <span class="md-ellipsis">
      ScaffoldUsedTwiceError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.join.join_scaffolds" class="md-nav__link">
    <span class="md-ellipsis">
      join_scaffolds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.join.joins_type" class="md-nav__link">
    <span class="md-ellipsis">
      joins_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.join.make_superscaffold_name" class="md-nav__link">
    <span class="md-ellipsis">
      make_superscaffold_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.join.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agp.remove" class="md-nav__link">
    <span class="md-ellipsis">
      remove
    </span>
  </a>
  
    <nav class="md-nav" aria-label="remove">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.remove.scaffolds_list_type" class="md-nav__link">
    <span class="md-ellipsis">
      scaffolds_list_type
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agp.rename" class="md-nav__link">
    <span class="md-ellipsis">
      rename
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rename">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.rename.rename_rows" class="md-nav__link">
    <span class="md-ellipsis">
      rename_rows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.rename.renaming_file_type" class="md-nav__link">
    <span class="md-ellipsis">
      renaming_file_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.rename.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agp.split" class="md-nav__link">
    <span class="md-ellipsis">
      split
    </span>
  </a>
  
    <nav class="md-nav" aria-label="split">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.split.ParsingError" class="md-nav__link">
    <span class="md-ellipsis">
      ParsingError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.split.breakpoints_type" class="md-nav__link">
    <span class="md-ellipsis">
      breakpoints_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.split.convert_rows" class="md-nav__link">
    <span class="md-ellipsis">
      convert_rows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.split.split_contig" class="md-nav__link">
    <span class="md-ellipsis">
      split_contig
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.split.split_scaffold" class="md-nav__link">
    <span class="md-ellipsis">
      split_scaffold
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.split.unoffset_rows" class="md-nav__link">
    <span class="md-ellipsis">
      unoffset_rows
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agp.transform" class="md-nav__link">
    <span class="md-ellipsis">
      transform
    </span>
  </a>
  
    <nav class="md-nav" aria-label="transform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.transform.BadOrientationError" class="md-nav__link">
    <span class="md-ellipsis">
      BadOrientationError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.transform.CoordinateNotFoundError" class="md-nav__link">
    <span class="md-ellipsis">
      CoordinateNotFoundError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.transform.UnsupportedOperationError" class="md-nav__link">
    <span class="md-ellipsis">
      UnsupportedOperationError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.transform.create_contig_dict" class="md-nav__link">
    <span class="md-ellipsis">
      create_contig_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.transform.find_agp_row" class="md-nav__link">
    <span class="md-ellipsis">
      find_agp_row
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.transform.transform_bed_row" class="md-nav__link">
    <span class="md-ellipsis">
      transform_bed_row
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.transform.transform_single_position" class="md-nav__link">
    <span class="md-ellipsis">
      transform_single_position
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#agp" class="md-nav__link">
    <span class="md-ellipsis">
      agp
    </span>
  </a>
  
    <nav class="md-nav" aria-label="agp">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.AgpFormatError" class="md-nav__link">
    <span class="md-ellipsis">
      AgpFormatError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow" class="md-nav__link">
    <span class="md-ellipsis">
      AgpRow
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AgpRow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.component_beg" class="md-nav__link">
    <span class="md-ellipsis">
      component_beg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.component_end" class="md-nav__link">
    <span class="md-ellipsis">
      component_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.component_id" class="md-nav__link">
    <span class="md-ellipsis">
      component_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.component_type" class="md-nav__link">
    <span class="md-ellipsis">
      component_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.gap_length" class="md-nav__link">
    <span class="md-ellipsis">
      gap_length
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.gap_type" class="md-nav__link">
    <span class="md-ellipsis">
      gap_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.is_gap" class="md-nav__link">
    <span class="md-ellipsis">
      is_gap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.linkage" class="md-nav__link">
    <span class="md-ellipsis">
      linkage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.linkage_evidence" class="md-nav__link">
    <span class="md-ellipsis">
      linkage_evidence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.object" class="md-nav__link">
    <span class="md-ellipsis">
      object
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.object_beg" class="md-nav__link">
    <span class="md-ellipsis">
      object_beg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.object_end" class="md-nav__link">
    <span class="md-ellipsis">
      object_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.orientation" class="md-nav__link">
    <span class="md-ellipsis">
      orientation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.part_number" class="md-nav__link">
    <span class="md-ellipsis">
      part_number
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.AgpRow.contains" class="md-nav__link">
    <span class="md-ellipsis">
      contains
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.is_string" class="md-nav__link">
    <span class="md-ellipsis">
      is_string
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.open_agp" class="md-nav__link">
    <span class="md-ellipsis">
      open_agp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.read" class="md-nav__link">
    <span class="md-ellipsis">
      read
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agp.assemble" class="md-nav__link">
    <span class="md-ellipsis">
      assemble
    </span>
  </a>
  
    <nav class="md-nav" aria-label="assemble">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.assemble.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agp.bed" class="md-nav__link">
    <span class="md-ellipsis">
      bed
    </span>
  </a>
  
    <nav class="md-nav" aria-label="bed">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.bed.BadRangeError" class="md-nav__link">
    <span class="md-ellipsis">
      BadRangeError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.bed.BedRange" class="md-nav__link">
    <span class="md-ellipsis">
      BedRange
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BedRange">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.bed.BedRange.chrom" class="md-nav__link">
    <span class="md-ellipsis">
      chrom
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.bed.BedRange.end" class="md-nav__link">
    <span class="md-ellipsis">
      end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.bed.BedRange.extra_fields" class="md-nav__link">
    <span class="md-ellipsis">
      extra_fields
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.bed.BedRange.start" class="md-nav__link">
    <span class="md-ellipsis">
      start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.bed.BedRange.strand" class="md-nav__link">
    <span class="md-ellipsis">
      strand
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.bed.EmptyRangeError" class="md-nav__link">
    <span class="md-ellipsis">
      EmptyRangeError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.bed.ParsingError" class="md-nav__link">
    <span class="md-ellipsis">
      ParsingError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.bed.open_bed" class="md-nav__link">
    <span class="md-ellipsis">
      open_bed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.bed.read" class="md-nav__link">
    <span class="md-ellipsis">
      read
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agp.flip" class="md-nav__link">
    <span class="md-ellipsis">
      flip
    </span>
  </a>
  
    <nav class="md-nav" aria-label="flip">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.flip.flip" class="md-nav__link">
    <span class="md-ellipsis">
      flip
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.flip.reverse_rows" class="md-nav__link">
    <span class="md-ellipsis">
      reverse_rows
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agp.join" class="md-nav__link">
    <span class="md-ellipsis">
      join
    </span>
  </a>
  
    <nav class="md-nav" aria-label="join">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.join.BadSequenceNameError" class="md-nav__link">
    <span class="md-ellipsis">
      BadSequenceNameError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.join.JoinGroup" class="md-nav__link">
    <span class="md-ellipsis">
      JoinGroup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.join.ScaffoldNotFoundError" class="md-nav__link">
    <span class="md-ellipsis">
      ScaffoldNotFoundError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.join.ScaffoldUsedTwiceError" class="md-nav__link">
    <span class="md-ellipsis">
      ScaffoldUsedTwiceError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.join.join_scaffolds" class="md-nav__link">
    <span class="md-ellipsis">
      join_scaffolds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.join.joins_type" class="md-nav__link">
    <span class="md-ellipsis">
      joins_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.join.make_superscaffold_name" class="md-nav__link">
    <span class="md-ellipsis">
      make_superscaffold_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.join.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agp.remove" class="md-nav__link">
    <span class="md-ellipsis">
      remove
    </span>
  </a>
  
    <nav class="md-nav" aria-label="remove">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.remove.scaffolds_list_type" class="md-nav__link">
    <span class="md-ellipsis">
      scaffolds_list_type
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agp.rename" class="md-nav__link">
    <span class="md-ellipsis">
      rename
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rename">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.rename.rename_rows" class="md-nav__link">
    <span class="md-ellipsis">
      rename_rows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.rename.renaming_file_type" class="md-nav__link">
    <span class="md-ellipsis">
      renaming_file_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.rename.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agp.split" class="md-nav__link">
    <span class="md-ellipsis">
      split
    </span>
  </a>
  
    <nav class="md-nav" aria-label="split">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.split.ParsingError" class="md-nav__link">
    <span class="md-ellipsis">
      ParsingError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.split.breakpoints_type" class="md-nav__link">
    <span class="md-ellipsis">
      breakpoints_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.split.convert_rows" class="md-nav__link">
    <span class="md-ellipsis">
      convert_rows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.split.split_contig" class="md-nav__link">
    <span class="md-ellipsis">
      split_contig
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.split.split_scaffold" class="md-nav__link">
    <span class="md-ellipsis">
      split_scaffold
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.split.unoffset_rows" class="md-nav__link">
    <span class="md-ellipsis">
      unoffset_rows
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agp.transform" class="md-nav__link">
    <span class="md-ellipsis">
      transform
    </span>
  </a>
  
    <nav class="md-nav" aria-label="transform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agp.transform.BadOrientationError" class="md-nav__link">
    <span class="md-ellipsis">
      BadOrientationError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.transform.CoordinateNotFoundError" class="md-nav__link">
    <span class="md-ellipsis">
      CoordinateNotFoundError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.transform.UnsupportedOperationError" class="md-nav__link">
    <span class="md-ellipsis">
      UnsupportedOperationError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.transform.create_contig_dict" class="md-nav__link">
    <span class="md-ellipsis">
      create_contig_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.transform.find_agp_row" class="md-nav__link">
    <span class="md-ellipsis">
      find_agp_row
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.transform.transform_bed_row" class="md-nav__link">
    <span class="md-ellipsis">
      transform_bed_row
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agp.transform.transform_single_position" class="md-nav__link">
    <span class="md-ellipsis">
      transform_single_position
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="api-reference">API reference</h1>


<div class="doc doc-object doc-module">



<h2 id="agp" class="doc doc-heading">
            <code>agp</code>


</h2>

    <div class="doc doc-contents first">

        <p>Functions for reading and writing AGP files.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="agp.AgpFormatError" class="doc doc-heading">
            <code>AgpFormatError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Invalidly formatted AGP</p>







              <details class="quote">
                <summary>Source code in <code>agp/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AgpFormatError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Invalidly formatted AGP&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="n">line</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Invalid AGP: &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agp.AgpRow" class="doc doc-heading">
            <code>AgpRow</code>


</h3>


    <div class="doc doc-contents ">


        <p>A single non-comment row of an AGP</p>
<p>A single non-comment row of an AGP file. Because AGP is a weird
kind of TSV where fields can have different meanings depending on
the value of the component_type field, I'm representing this as a
class with instance variables rather than an OrderedDict or
something along those lines. See the NCBI documentation for more
information:</p>
<p><a href="https://www.ncbi.nlm.nih.gov/assembly/agp/AGP_Specification/">https://www.ncbi.nlm.nih.gov/assembly/agp/AGP_Specification/</a></p>







              <details class="quote">
                <summary>Source code in <code>agp/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AgpRow</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A single non-comment row of an AGP</span>

<span class="sd">    A single non-comment row of an AGP file. Because AGP is a weird</span>
<span class="sd">    kind of TSV where fields can have different meanings depending on</span>
<span class="sd">    the value of the component_type field, I&#39;m representing this as a</span>
<span class="sd">    class with instance variables rather than an OrderedDict or</span>
<span class="sd">    something along those lines. See the NCBI documentation for more</span>
<span class="sd">    information:</span>

<span class="sd">    &lt;https://www.ncbi.nlm.nih.gov/assembly/agp/AGP_Specification/&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a new instance of AgpRow</span>

<span class="sd">        Creates a new instance of AgpRow by parsing the given line of</span>
<span class="sd">        text.</span>

<span class="sd">        Args:</span>
<span class="sd">            line: a line of text in AGP format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">splits</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;object column of AGP&quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object_beg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;object_beg column of AGP&quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object_end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;object_end column of AGP&quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">part_number</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;part_number column of AGP&quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">component_type</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;component_type column of AGP&quot;&quot;&quot;</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">component_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="s2">&quot;U&quot;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">is_gap</span> <span class="o">=</span> <span class="kc">True</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;is_gap column of AGP&quot;&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gap_length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;gap_length column of AGP&quot;&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gap_type</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;gap_type column of AGP&quot;&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">linkage</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;linkage column of AGP&quot;&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">linkage_evidence</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;linkage_evidence column of AGP&quot;&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">is_gap</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">component_id</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;component_id column of AGP&quot;&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">component_beg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;component_beg column of AGP&quot;&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">component_end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;component_end column of AGP&quot;&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;orientation column of AGP&quot;&quot;&quot;</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AgpFormatError</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the string representation of the AGP row as a line of</span>
<span class="sd">        text containing all the fields separated by tabs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_gap</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="nb">map</span><span class="p">(</span>
                    <span class="nb">str</span><span class="p">,</span>
                    <span class="p">[</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object_beg</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object_end</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">part_number</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">component_type</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">gap_length</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">gap_type</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">linkage</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">linkage_evidence</span><span class="p">,</span>
                    <span class="p">],</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="nb">map</span><span class="p">(</span>
                    <span class="nb">str</span><span class="p">,</span>
                    <span class="p">[</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object_beg</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object_end</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">part_number</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">component_type</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">component_id</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">component_beg</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">component_end</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span><span class="p">,</span>
                    <span class="p">],</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_gap</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">is_gap</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">common_field_equality</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">object</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_beg</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">object_beg</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_end</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">object_end</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">part_number</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">part_number</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">component_type</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">component_type</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_gap</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">common_field_equality</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap_length</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">gap_length</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap_type</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">gap_type</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">linkage</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">linkage</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">linkage_evidence</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">linkage_evidence</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">common_field_equality</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">component_id</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">component_id</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">component_beg</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">component_beg</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">component_end</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">component_end</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">orientation</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check whether a row contains a position</span>

<span class="sd">        Determine whether this row contains a given coordinate.</span>

<span class="sd">        Args:</span>
<span class="sd">            position: a genomic position in base pairs</span>

<span class="sd">        Returns:</span>
<span class="sd">            true if position is within the bounds of this entry, false</span>
<span class="sd">                otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_beg</span> <span class="o">&lt;=</span> <span class="n">position</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_end</span> <span class="o">&gt;=</span> <span class="n">position</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="agp.AgpRow.component_beg" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">component_beg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>component_beg column of AGP</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agp.AgpRow.component_end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">component_end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>component_end column of AGP</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agp.AgpRow.component_id" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">component_id</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>component_id column of AGP</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agp.AgpRow.component_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">component_type</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>component_type column of AGP</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agp.AgpRow.gap_length" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">gap_length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>gap_length column of AGP</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agp.AgpRow.gap_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">gap_type</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>gap_type column of AGP</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agp.AgpRow.is_gap" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_gap</span> <span class="o">=</span> <span class="kc">True</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>is_gap column of AGP</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agp.AgpRow.linkage" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">linkage</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>linkage column of AGP</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agp.AgpRow.linkage_evidence" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">linkage_evidence</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>linkage_evidence column of AGP</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agp.AgpRow.object" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">object</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>object column of AGP</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agp.AgpRow.object_beg" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">object_beg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>object_beg column of AGP</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agp.AgpRow.object_end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">object_end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>object_end column of AGP</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agp.AgpRow.orientation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">orientation</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>orientation column of AGP</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agp.AgpRow.part_number" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">part_number</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>part_number column of AGP</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="agp.AgpRow.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">line</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Creates a new instance of AgpRow</p>
<p>Creates a new instance of AgpRow by parsing the given line of
text.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>line</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a line of text in AGP format</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a new instance of AgpRow</span>

<span class="sd">    Creates a new instance of AgpRow by parsing the given line of</span>
<span class="sd">    text.</span>

<span class="sd">    Args:</span>
<span class="sd">        line: a line of text in AGP format</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">splits</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;object column of AGP&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object_beg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;object_beg column of AGP&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object_end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;object_end column of AGP&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">part_number</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;part_number column of AGP&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">component_type</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;component_type column of AGP&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">component_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="s2">&quot;U&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_gap</span> <span class="o">=</span> <span class="kc">True</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;is_gap column of AGP&quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gap_length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;gap_length column of AGP&quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gap_type</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;gap_type column of AGP&quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">linkage</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;linkage column of AGP&quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">linkage_evidence</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;linkage_evidence column of AGP&quot;&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_gap</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">component_id</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;component_id column of AGP&quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">component_beg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;component_beg column of AGP&quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">component_end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;component_end column of AGP&quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;orientation column of AGP&quot;&quot;&quot;</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">AgpFormatError</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agp.AgpRow.__str__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Returns the string representation of the AGP row as a line of
text containing all the fields separated by tabs.</p>


            <details class="quote">
              <summary>Source code in <code>agp/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the string representation of the AGP row as a line of</span>
<span class="sd">    text containing all the fields separated by tabs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_gap</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="nb">map</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">,</span>
                <span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object_beg</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object_end</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">part_number</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">component_type</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gap_length</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gap_type</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">linkage</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">linkage_evidence</span><span class="p">,</span>
                <span class="p">],</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="nb">map</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">,</span>
                <span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object_beg</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object_end</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">part_number</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">component_type</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">component_id</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">component_beg</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">component_end</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span><span class="p">,</span>
                <span class="p">],</span>
            <span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agp.AgpRow.contains" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">contains</span><span class="p">(</span><span class="n">position</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Check whether a row contains a position</p>
<p>Determine whether this row contains a given coordinate.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>position</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a genomic position in base pairs</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>true if position is within the bounds of this entry, false
otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check whether a row contains a position</span>

<span class="sd">    Determine whether this row contains a given coordinate.</span>

<span class="sd">    Args:</span>
<span class="sd">        position: a genomic position in base pairs</span>

<span class="sd">    Returns:</span>
<span class="sd">        true if position is within the bounds of this entry, false</span>
<span class="sd">            otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_beg</span> <span class="o">&lt;=</span> <span class="n">position</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_end</span> <span class="o">&gt;=</span> <span class="n">position</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="agp.is_string" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_string</span><span class="p">(</span><span class="n">var</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Determine whether var is a string</p>
<p>Determine whether <code>var</code> is a string.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>var</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>variable to check for stringiness</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>true if <code>var</code> is a string, false otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_string</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine whether var is a string</span>

<span class="sd">    Determine whether `var` is a string.</span>

<span class="sd">    Args:</span>
<span class="sd">        var: variable to check for stringiness</span>

<span class="sd">    Returns:</span>
<span class="sd">        true if `var` is a string, false otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agp.open_agp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">open_agp</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Open and read an AGP file</p>
<p>Open an AGP file from a path, and then parse it</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>path to an AGP file to read</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Iterator">Iterator</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>an Iterator over the rows of the file</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">open_agp</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">AgpRow</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Open and read an AGP file</span>

<span class="sd">    Open an AGP file from a path, and then parse it</span>

<span class="sd">    Args:</span>
<span class="sd">        filename: path to an AGP file to read</span>

<span class="sd">    Returns:</span>
<span class="sd">        an Iterator over the rows of the file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">read</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agp.read" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Read an AGP file</p>
<p>Read an AGP file, yielding rows as AgpRow instances and comment
lines as plain strings.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>infile</code>
            </td>
            <td>
                  <code><span title="typing.TextIO">TextIO</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>input file in AGP format</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>each row as either a string containing the entire line for</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>comments, or an AgpRow for non-comment lines</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">read</span><span class="p">(</span><span class="n">infile</span><span class="p">:</span> <span class="n">TextIO</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">AgpRow</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read an AGP file</span>

<span class="sd">    Read an AGP file, yielding rows as AgpRow instances and comment</span>
<span class="sd">    lines as plain strings.</span>

<span class="sd">    Args:</span>
<span class="sd">        infile: input file in AGP format</span>

<span class="sd">    Yields:</span>
<span class="sd">        each row as either a string containing the entire line for</span>
<span class="sd">        comments, or an AgpRow for non-comment lines</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">infile</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">AgpRow</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="agp.assemble" class="doc doc-heading">
            <code>agp.assemble</code>


</h2>

    <div class="doc doc-contents first">

        <p>Functions for assembling scaffolds from contigs based on an agp file</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="agp.assemble.run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="n">contigs_fasta</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">agp_rows</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Given contigs in fasta format and their order and orientation into
scaffolds in AGP format, outputs the assembled scaffolds in fasta
format.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>contigs_fasta</code>
            </td>
            <td>
                  <code><span title="screed.openscreed.Open">Open</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>fasta iterator in screed format containing contigs</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>outfile</code>
            </td>
            <td>
                  <code><span title="typing.IO">IO</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>file where scaffolds fasta should be written</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>agp_rows</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>iterable returning agp.AgpRow objects, each
containing a single row of the agp file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/assemble.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span>
    <span class="n">contigs_fasta</span><span class="p">:</span> <span class="n">screed</span><span class="o">.</span><span class="n">openscreed</span><span class="o">.</span><span class="n">Open</span><span class="p">,</span> <span class="n">outfile</span><span class="p">:</span> <span class="n">IO</span><span class="p">,</span> <span class="n">agp_rows</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">agp</span><span class="o">.</span><span class="n">AgpRow</span><span class="p">]</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given contigs in fasta format and their order and orientation into</span>
<span class="sd">    scaffolds in AGP format, outputs the assembled scaffolds in fasta</span>
<span class="sd">    format.</span>

<span class="sd">    Args:</span>
<span class="sd">        contigs_fasta: fasta iterator in screed format containing contigs</span>
<span class="sd">        outfile: file where scaffolds fasta should be written</span>
<span class="sd">        agp_rows: iterable returning agp.AgpRow objects, each</span>
<span class="sd">            containing a single row of the agp file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># unfortunately, the contigs fasta file I&#39;m writing this for has</span>
    <span class="c1"># variable line-length and is thus not faidx-able, so we have to</span>
    <span class="c1"># load it into memory :(</span>
    <span class="n">contigs</span> <span class="o">=</span> <span class="p">{</span><span class="n">record</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">record</span><span class="o">.</span><span class="n">sequence</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">contigs_fasta</span><span class="p">}</span>

    <span class="n">current_sequence</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">current_chrom</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># loop through AGP, skipping comment lines, which my agp library</span>
    <span class="c1"># yields as strings</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">filterfalse</span><span class="p">(</span><span class="n">agp</span><span class="o">.</span><span class="n">is_string</span><span class="p">,</span> <span class="n">agp_rows</span><span class="p">):</span>
        <span class="c1"># check if starting a new chromosome</span>
        <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">object</span> <span class="o">!=</span> <span class="n">current_chrom</span><span class="p">:</span>
            <span class="c1"># if this is not the first chromosome, output the previous</span>
            <span class="c1"># chromosome</span>
            <span class="k">if</span> <span class="n">current_chrom</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">print_fasta</span><span class="p">(</span><span class="n">current_chrom</span><span class="p">,</span> <span class="n">current_sequence</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="n">outfile</span><span class="p">)</span>
            <span class="c1"># start the new chromosome as an empty sequence</span>
            <span class="n">current_chrom</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">object</span>
            <span class="n">current_sequence</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">is_gap</span> <span class="ow">and</span> <span class="n">current_sequence</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">current_sequence</span> <span class="o">+=</span> <span class="s2">&quot;N&quot;</span> <span class="o">*</span> <span class="n">row</span><span class="o">.</span><span class="n">gap_length</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">component_beg</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">component_end</span>
            <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">component_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">contigs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">raise</span> <span class="n">NoSuchContigError</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">component_id</span><span class="p">)</span>
            <span class="n">component</span> <span class="o">=</span> <span class="n">contigs</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">component_id</span><span class="p">][</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">orientation</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>
                <span class="n">component</span> <span class="o">=</span> <span class="n">reverse_complement</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
            <span class="n">current_sequence</span> <span class="o">+=</span> <span class="n">component</span>

    <span class="k">if</span> <span class="n">current_sequence</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">current_chrom</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">print_fasta</span><span class="p">(</span><span class="n">current_chrom</span><span class="p">,</span> <span class="n">current_sequence</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="n">outfile</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">EmptyAgpError</span><span class="p">(</span><span class="s2">&quot;The input agp has no components!&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="agp.bed" class="doc doc-heading">
            <code>agp.bed</code>


</h2>

    <div class="doc doc-contents first">

        <p>Functions for parsing bed files</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="agp.bed.BadRangeError" class="doc doc-heading">
            <code>BadRangeError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Error raised when range starts in middle of component</p>







              <details class="quote">
                <summary>Source code in <code>agp/bed.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BadRangeError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Error raised when range starts in middle of component&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bed_range</span><span class="p">:</span> <span class="s2">&quot;BedRange&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bed_range</span> <span class="o">=</span> <span class="n">bed_range</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="s2">&quot;The bed range </span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2"> starts and/or ends in the middle of a&quot;</span>
            <span class="s2">&quot;component. This is not supported in this module.&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bed_range</span><span class="o">.</span><span class="n">chrom</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bed_range</span><span class="o">.</span><span class="n">start</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bed_range</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agp.bed.BedRange" class="doc doc-heading">
            <code>BedRange</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Single entry (i.e., line) of a bed file.</p>







              <details class="quote">
                <summary>Source code in <code>agp/bed.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BedRange</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Single entry (i.e., line) of a bed file.&quot;&quot;&quot;</span>

    <span class="n">chrom</span><span class="p">:</span> <span class="nb">str</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Name of the chromosome or sequence of the bed range&quot;&quot;&quot;</span>
    <span class="n">start</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Start position of the bed range&quot;&quot;&quot;</span>
    <span class="n">end</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;End position of the bed range&quot;&quot;&quot;</span>
    <span class="n">strand</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Strand of the bed range (either &#39;+&#39; or &#39;-&#39;)&quot;&quot;&quot;</span>
    <span class="n">extra_fields</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Additional columns containing miscellaneous data&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">fields</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chrom</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">:</span>
            <span class="n">fields</span> <span class="o">+=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strand</span><span class="p">:</span>
                <span class="n">fields</span> <span class="o">+=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">strand</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extra_fields</span><span class="p">:</span>
                <span class="n">fields</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extra_fields</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">fields</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="agp.bed.BedRange.chrom" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">chrom</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Name of the chromosome or sequence of the bed range</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agp.bed.BedRange.end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">end</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>End position of the bed range</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agp.bed.BedRange.extra_fields" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extra_fields</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Additional columns containing miscellaneous data</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agp.bed.BedRange.start" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">start</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Start position of the bed range</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agp.bed.BedRange.strand" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">strand</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Strand of the bed range (either '+' or '-')</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agp.bed.EmptyRangeError" class="doc doc-heading">
            <code>EmptyRangeError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Error raised when bed range contains no contigs</p>







              <details class="quote">
                <summary>Source code in <code>agp/bed.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">EmptyRangeError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Error raised when bed range contains no contigs&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bed_range</span><span class="p">:</span> <span class="s2">&quot;BedRange&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bed_range</span> <span class="o">=</span> <span class="n">bed_range</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;The range </span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2"> does not contain any contigs.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bed_range</span><span class="o">.</span><span class="n">chrom</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bed_range</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bed_range</span><span class="o">.</span><span class="n">end</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agp.bed.ParsingError" class="doc doc-heading">
            <code>ParsingError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Error parsing bed file</p>







              <details class="quote">
                <summary>Source code in <code>agp/bed.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ParsingError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Error parsing bed file&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="agp.bed.open_bed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">open_bed</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Open and parse a bed file</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>path to a bed file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/bed.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">open_bed</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">BedRange</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Open and parse a bed file</span>

<span class="sd">    Args:</span>
<span class="sd">        filename: path to a bed file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">read</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agp.bed.read" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read</span><span class="p">(</span><span class="n">bedfile</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Read and parse a bed file</p>
<p>Read a bed file line by line. If a line contains start and end
positions, yield the sequence name and start and end positions as
a BedRange; if the line contains only a sequence name, yield a
BedRange with {start,end}=None.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>bedfile</code>
            </td>
            <td>
                  <code><span title="typing.TextIO">TextIO</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a bed-formatted file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Iterator">Iterator</span>[<a class="autorefs autorefs-internal" title="BedRange


  
      dataclass
   (agp.bed.BedRange)" href="#agp.bed.BedRange">BedRange</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>an iterator that yields single lines of the file at a time</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/bed.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">read</span><span class="p">(</span><span class="n">bedfile</span><span class="p">:</span> <span class="n">TextIO</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">BedRange</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read and parse a bed file</span>

<span class="sd">    Read a bed file line by line. If a line contains start and end</span>
<span class="sd">    positions, yield the sequence name and start and end positions as</span>
<span class="sd">    a BedRange; if the line contains only a sequence name, yield a</span>
<span class="sd">    BedRange with {start,end}=None.</span>

<span class="sd">    Args:</span>
<span class="sd">        bedfile: a bed-formatted file</span>

<span class="sd">    Returns:</span>
<span class="sd">        an iterator that yields single lines of the file at a time</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bedfile</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">empty_line_regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
            <span class="n">splits</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">splits</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">BedRange</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">splits</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ParsingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Line </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> of bed misformatted.&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">splits</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">BedRange</span><span class="p">(</span>
                        <span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">start</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                        <span class="n">end</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">BedRange</span><span class="p">(</span>
                        <span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">start</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                        <span class="n">end</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                        <span class="n">strand</span><span class="o">=</span><span class="n">splits</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">extra_fields</span><span class="o">=</span><span class="n">splits</span><span class="p">[</span><span class="mi">4</span><span class="p">:],</span>
                    <span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">ParsingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Line </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> of bed misformatted.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="agp.flip" class="doc doc-heading">
            <code>agp.flip</code>


</h2>

    <div class="doc doc-contents first">

        <p>Given an AGP file describing an assembly and a list of chromosomes to
flip, output a new AGP file with those chromosomes reoriented in
reverse-complement.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="agp.flip.flip" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">flip</span><span class="p">(</span><span class="n">agp_rows</span><span class="p">,</span> <span class="n">ranges_to_flip</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Reverse-complements all rows of an AGP file that fall within a list
of ranges.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>agp_rows</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>all rows in an AGP file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ranges_to_flip</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="BedRange


  
      dataclass
   (agp.bed.BedRange)" href="#agp.bed.BedRange">BedRange</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list of ranges in the AGP file to
reverse-complement. Takes genomic (bed) coordinates, not
array coordinates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>agp_rows</code></td>            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the same rows that were input, except the rows in the
specified range are now reverse-complemented</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/flip.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">flip</span><span class="p">(</span>
    <span class="n">agp_rows</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">AgpRow</span><span class="p">],</span> <span class="n">ranges_to_flip</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">BedRange</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">AgpRow</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reverse-complements all rows of an AGP file that fall within a list</span>
<span class="sd">    of ranges.</span>

<span class="sd">    Args:</span>
<span class="sd">        agp_rows: all rows in an AGP file</span>
<span class="sd">        ranges_to_flip: a list of ranges in the AGP file to</span>
<span class="sd">            reverse-complement. Takes genomic (bed) coordinates, not</span>
<span class="sd">            array coordinates.</span>

<span class="sd">    Returns:</span>
<span class="sd">        agp_rows: the same rows that were input, except the rows in the</span>
<span class="sd">            specified range are now reverse-complemented</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># agp_rows is a generator, but we&#39;re going to have to store the</span>
    <span class="c1"># whole agp in memory</span>
    <span class="n">agp_rows</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">agp_rows</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">bed_range</span> <span class="ow">in</span> <span class="n">ranges_to_flip</span><span class="p">:</span>
        <span class="c1"># list of tuples (i, agp_row) of rows in bed_range</span>
        <span class="n">rows_to_reverse</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">AgpRow</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">agp_rows</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">row</span><span class="o">.</span><span class="n">object</span> <span class="o">==</span> <span class="n">bed_range</span><span class="o">.</span><span class="n">chrom</span><span class="p">:</span>
                <span class="c1"># if no range in seq specified, flip the whole sequence</span>
                <span class="k">if</span> <span class="n">bed_range</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">bed_range</span><span class="o">.</span><span class="n">end</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">rows_to_reverse</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">row</span><span class="p">))</span>
                <span class="c1"># otherwise, flip only the part within range</span>
                <span class="k">elif</span> <span class="p">(</span>
                    <span class="n">row</span><span class="o">.</span><span class="n">object_beg</span> <span class="o">&gt;=</span> <span class="n">bed_range</span><span class="o">.</span><span class="n">start</span>
                    <span class="ow">and</span> <span class="n">row</span><span class="o">.</span><span class="n">object_end</span> <span class="o">&lt;=</span> <span class="n">bed_range</span><span class="o">.</span><span class="n">end</span>
                <span class="p">):</span>
                    <span class="n">rows_to_reverse</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">row</span><span class="p">))</span>
                <span class="c1"># check for bad ranges (i.e., ones that only partially</span>
                <span class="c1"># contain a component)</span>
                <span class="k">elif</span> <span class="p">(</span><span class="n">bed_range</span><span class="o">.</span><span class="n">start</span> <span class="ow">and</span> <span class="n">bed_range</span><span class="o">.</span><span class="n">end</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="n">row</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">bed_range</span><span class="o">.</span><span class="n">start</span><span class="p">)</span> <span class="ow">or</span> <span class="n">row</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">bed_range</span><span class="o">.</span><span class="n">end</span><span class="p">)</span>
                <span class="p">):</span>
                    <span class="k">raise</span> <span class="n">bed</span><span class="o">.</span><span class="n">BadRangeError</span><span class="p">(</span><span class="n">bed_range</span><span class="p">)</span>

        <span class="c1"># unzip and flip those rows we&#39;ve collected</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows_to_reverse</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">bed</span><span class="o">.</span><span class="n">EmptyRangeError</span><span class="p">(</span><span class="n">bed_range</span><span class="p">)</span>
        <span class="n">unzipped</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">rows_to_reverse</span><span class="p">))</span>
        <span class="n">indices</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">unzipped</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">rows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">AgpRow</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">unzipped</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">reversed_rows</span> <span class="o">=</span> <span class="n">reverse_rows</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>

        <span class="c1"># replace the original rows with the reversed rows</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">reversed_rows</span><span class="p">):</span>
            <span class="n">agp_rows</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span>

    <span class="k">return</span> <span class="n">agp_rows</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agp.flip.reverse_rows" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reverse_rows</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Given a list of AGP rows, return a new set of rows assembling
the reverse complement of the input rows.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rows</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>an ordered list of AgpRow objects to reverse</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the input, except in reverse order, with the rows modified to be</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>reverse-complements</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/flip.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reverse_rows</span><span class="p">(</span><span class="n">rows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">AgpRow</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">AgpRow</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a list of AGP rows, return a new set of rows assembling</span>
<span class="sd">    the reverse complement of the input rows.</span>

<span class="sd">    Args:</span>
<span class="sd">        rows: an ordered list of AgpRow objects to reverse</span>

<span class="sd">    Returns:</span>
<span class="sd">        the input, except in reverse order, with the rows modified to be</span>
<span class="sd">        reverse-complements</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># first, get the first and last part numbers and the start and end</span>
    <span class="c1"># position of the entire segment being flipped so we can count</span>
    <span class="c1"># backwards from there.</span>
    <span class="n">first_part_number</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">part_number</span>
    <span class="n">last_part_number</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">part_number</span>
    <span class="n">first_part_start</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">object_beg</span>
    <span class="n">last_part_end</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">object_end</span>

    <span class="n">reversed_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
        <span class="n">new_start</span> <span class="o">=</span> <span class="n">first_part_start</span> <span class="o">+</span> <span class="n">last_part_end</span> <span class="o">-</span> <span class="n">row</span><span class="o">.</span><span class="n">object_end</span>
        <span class="n">new_end</span> <span class="o">=</span> <span class="n">first_part_start</span> <span class="o">+</span> <span class="n">last_part_end</span> <span class="o">-</span> <span class="n">row</span><span class="o">.</span><span class="n">object_beg</span>
        <span class="n">row</span><span class="o">.</span><span class="n">object_beg</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">object_end</span> <span class="o">=</span> <span class="n">new_start</span><span class="p">,</span> <span class="n">new_end</span>

        <span class="n">row</span><span class="o">.</span><span class="n">part_number</span> <span class="o">=</span> <span class="n">first_part_number</span> <span class="o">+</span> <span class="n">last_part_number</span> <span class="o">-</span> <span class="n">row</span><span class="o">.</span><span class="n">part_number</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">row</span><span class="o">.</span><span class="n">is_gap</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">orientation</span> <span class="o">==</span> <span class="s2">&quot;+&quot;</span><span class="p">:</span>
                <span class="n">row</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">row</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span>

        <span class="n">reversed_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">reversed_rows</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="agp.join" class="doc doc-heading">
            <code>agp.join</code>


</h2>

    <div class="doc doc-contents first">

        <p>Functions for joining scaffolds</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="agp.join.BadSequenceNameError" class="doc doc-heading">
            <code>BadSequenceNameError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Sequence name is not allowed</p>







              <details class="quote">
                <summary>Source code in <code>agp/join.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BadSequenceNameError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sequence name is not allowed&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Bad scaffold name: &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;. Only [a-zA-Z0-9._] allowed.&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agp.join.JoinGroup" class="doc doc-heading">
            <code>JoinGroup</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="collections.abc.Sequence">Sequence</span></code></p>


        <p>A group of scaffolds to be joined together</p>
<p>This class represents a group of scaffolds that should be joined
together as specified in a joins file. Optionally, a group can be given
a name to use for the new superscaffold instead of using
<code>make_superscaffold_name()</code> to make one up based on the names of the
components. If accessed as a <code>Sequence</code>, it provides direct access to
the underlying list of scaffolds, e.g.,</p>
<blockquote>
<blockquote>
<blockquote>
<p>from agp.join import JoinGroup
join_group = JoinGroup(["scaffold_1", "-scaffold_2", "+scaffold_3"])
len(join_group)
3
join_group[1]
'-scaffold_2'</p>
</blockquote>
</blockquote>
</blockquote>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="agp.join.JoinGroup.scaffolds">scaffolds</span></code></td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list of scaffolds to join together, in the correct
order. A scaffold name can be preceded by "+" or "-" to
indicate orientation; if none is specified, "+" is assumed.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="agp.join.JoinGroup.name">name</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a name to use for the new superscaffold in the output agp</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>agp/join.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">JoinGroup</span><span class="p">(</span><span class="n">Sequence</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A group of scaffolds to be joined together</span>

<span class="sd">    This class represents a group of scaffolds that should be joined</span>
<span class="sd">    together as specified in a joins file. Optionally, a group can be given</span>
<span class="sd">    a name to use for the new superscaffold instead of using</span>
<span class="sd">    `make_superscaffold_name()` to make one up based on the names of the</span>
<span class="sd">    components. If accessed as a `Sequence`, it provides direct access to</span>
<span class="sd">    the underlying list of scaffolds, e.g.,</span>

<span class="sd">    &gt;&gt;&gt; from agp.join import JoinGroup</span>
<span class="sd">    &gt;&gt;&gt; join_group = JoinGroup([&quot;scaffold_1&quot;, &quot;-scaffold_2&quot;, &quot;+scaffold_3&quot;])</span>
<span class="sd">    &gt;&gt;&gt; len(join_group)</span>
<span class="sd">    3</span>
<span class="sd">    &gt;&gt;&gt; join_group[1]</span>
<span class="sd">    &#39;-scaffold_2&#39;</span>

<span class="sd">    Attributes:</span>
<span class="sd">        scaffolds: a list of scaffolds to join together, in the correct</span>
<span class="sd">            order. A scaffold name can be preceded by &quot;+&quot; or &quot;-&quot; to</span>
<span class="sd">            indicate orientation; if none is specified, &quot;+&quot; is assumed.</span>
<span class="sd">        name: a name to use for the new superscaffold in the output agp</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">scaffolds</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaffolds</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scaffolds</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agp.join.ScaffoldNotFoundError" class="doc doc-heading">
            <code>ScaffoldNotFoundError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Scaffold in joins list not found in agp</p>







              <details class="quote">
                <summary>Source code in <code>agp/join.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ScaffoldNotFoundError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scaffold in joins list not found in agp&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agp.join.ScaffoldUsedTwiceError" class="doc doc-heading">
            <code>ScaffoldUsedTwiceError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Scaffold(s) used more than once in joins file</p>







              <details class="quote">
                <summary>Source code in <code>agp/join.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ScaffoldUsedTwiceError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scaffold(s) used more than once in joins file&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="agp.join.join_scaffolds" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">join_scaffolds</span><span class="p">(</span><span class="n">superscaffold_rows</span><span class="p">,</span> <span class="n">gap_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">gap_type</span><span class="o">=</span><span class="s1">&#39;scaffold&#39;</span><span class="p">,</span> <span class="n">gap_evidence</span><span class="o">=</span><span class="s1">&#39;na&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Transforms agp rows from multiple scaffolds into agp rows for a
single superscaffold containing all the given scaffolds in the
specified order. Scaffolds should be oriented properly before
using this function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>superscaffold_rows</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list of lists of agp rows. Each sub-list is a
list of all rows in a single scaffold. These scaffolds will be
joined in the order given</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gap_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>length of the new gaps created by joining scaffolds
together</p>
              </div>
            </td>
            <td>
                  <code>500</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gap_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>what to call the new gaps in the agp file</p>
              </div>
            </td>
            <td>
                  <code>&#39;scaffold&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gap_evidence</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>evidence type for linkage across gap</p>
              </div>
            </td>
            <td>
                  <code>&#39;na&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>name of new superscaffold. If None, this function will come
up with a name based on the names of subscaffolds contained by
this superscaffold</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list of AgpRow instances containing the new scaffold specification</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/join.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">join_scaffolds</span><span class="p">(</span>
    <span class="n">superscaffold_rows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">AgpRow</span><span class="p">]],</span>
    <span class="n">gap_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="n">gap_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;scaffold&quot;</span><span class="p">,</span>
    <span class="n">gap_evidence</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;na&quot;</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">AgpRow</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transforms agp rows from multiple scaffolds into agp rows for a</span>
<span class="sd">    single superscaffold containing all the given scaffolds in the</span>
<span class="sd">    specified order. Scaffolds should be oriented properly before</span>
<span class="sd">    using this function.</span>

<span class="sd">    Args:</span>
<span class="sd">        superscaffold_rows: a list of lists of agp rows. Each sub-list is a</span>
<span class="sd">            list of all rows in a single scaffold. These scaffolds will be</span>
<span class="sd">            joined in the order given</span>
<span class="sd">        gap_size: length of the new gaps created by joining scaffolds</span>
<span class="sd">            together</span>
<span class="sd">        gap_type: what to call the new gaps in the agp file</span>
<span class="sd">        gap_evidence: evidence type for linkage across gap</span>
<span class="sd">        name: name of new superscaffold. If None, this function will come</span>
<span class="sd">            up with a name based on the names of subscaffolds contained by</span>
<span class="sd">            this superscaffold</span>

<span class="sd">    Returns:</span>
<span class="sd">        a list of AgpRow instances containing the new scaffold specification</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># make a nice name for the new superscaffold we are creating</span>
    <span class="n">subscaffold_names</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">object</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">superscaffold_rows</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">superscaffold_name</span> <span class="o">=</span> <span class="n">make_superscaffold_name</span><span class="p">(</span><span class="n">subscaffold_names</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">superscaffold_name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="c1"># keeps track of what component number of the superscaffold we are</span>
    <span class="c1"># currently on</span>
    <span class="n">component_number_counter</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c1"># keeps track of the ending position of the previous subscaffold,</span>
    <span class="c1"># so that we can add it as an offset to components of the current</span>
    <span class="c1"># subscaffold</span>
    <span class="n">end_of_previous_scaffold</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># list(AgpRow) containing the rows to be returned</span>
    <span class="n">outrows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># loop over the subscaffolds</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">this_scaffold_rows</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">superscaffold_rows</span><span class="p">):</span>
        <span class="c1"># loop over the agp rows in this subscaffold</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">this_scaffold_rows</span><span class="p">:</span>
            <span class="c1"># update the current row and put it in the output list</span>
            <span class="n">row</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">superscaffold_name</span>
            <span class="n">row</span><span class="o">.</span><span class="n">part_number</span> <span class="o">=</span> <span class="n">component_number_counter</span>
            <span class="n">component_number_counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">row</span><span class="o">.</span><span class="n">object_beg</span> <span class="o">+=</span> <span class="n">end_of_previous_scaffold</span>
            <span class="n">row</span><span class="o">.</span><span class="n">object_end</span> <span class="o">+=</span> <span class="n">end_of_previous_scaffold</span>
            <span class="n">outrows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="n">end_of_previous_scaffold</span> <span class="o">=</span> <span class="n">outrows</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">object_end</span>

        <span class="c1"># add a gap if we&#39;re not on the last subscaffold</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">superscaffold_rows</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">outrows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">GapRow</span><span class="p">(</span>
                    <span class="n">superscaffold_name</span><span class="p">,</span>
                    <span class="n">end_of_previous_scaffold</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="n">end_of_previous_scaffold</span> <span class="o">+</span> <span class="n">gap_size</span><span class="p">,</span>
                    <span class="n">component_number_counter</span><span class="p">,</span>
                    <span class="n">length</span><span class="o">=</span><span class="n">gap_size</span><span class="p">,</span>
                    <span class="n">gap_type</span><span class="o">=</span><span class="n">gap_type</span><span class="p">,</span>
                    <span class="n">evidence</span><span class="o">=</span><span class="n">gap_evidence</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">component_number_counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">end_of_previous_scaffold</span> <span class="o">=</span> <span class="n">outrows</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">object_end</span>

    <span class="k">return</span> <span class="n">outrows</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agp.join.joins_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">joins_type</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>argparse type function for file listing scaffold joins</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>filename giving path to a file listing
scaffolds to join. Each line should contain a comma-
separated list of scaffolds to be joined into a single
scaffold. Optionally, the file can contain a second column
after a tab that gives each group a name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="JoinGroup


  
      dataclass
   (agp.join.JoinGroup)" href="#agp.join.JoinGroup">JoinGroup</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of join groups. Scaffold names may have "+" or "-"
before their name; that is the job of downstream code to handle.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ScaffoldUsedTwiceError (agp.join.ScaffoldUsedTwiceError)" href="#agp.join.ScaffoldUsedTwiceError">ScaffoldUsedTwiceError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if a scaffold is used multiple times</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/join.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">joins_type</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">JoinGroup</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    argparse type function for file listing scaffold joins</span>

<span class="sd">    Args:</span>
<span class="sd">        filename: filename giving path to a file listing</span>
<span class="sd">            scaffolds to join. Each line should contain a comma-</span>
<span class="sd">            separated list of scaffolds to be joined into a single</span>
<span class="sd">            scaffold. Optionally, the file can contain a second column</span>
<span class="sd">            after a tab that gives each group a name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of join groups. Scaffold names may have &quot;+&quot; or &quot;-&quot;</span>
<span class="sd">            before their name; that is the job of downstream code to handle.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ScaffoldUsedTwiceError: if a scaffold is used multiple times</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">joins</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">JoinGroup</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">joins_file</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">joins_file</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">empty_line_regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">join_group</span> <span class="o">=</span> <span class="n">JoinGroup</span><span class="p">(</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">))</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">sequence_name_regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="k">raise</span> <span class="n">BadSequenceNameError</span><span class="p">(</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">join_group</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">joins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">join_group</span><span class="p">)</span>

    <span class="c1"># look for scaffolds used more than once</span>
    <span class="n">scaffold_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;+-&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">joins</span><span class="p">))</span>
    <span class="n">reused_scaffolds</span> <span class="o">=</span> <span class="p">[</span><span class="n">scaf</span> <span class="k">for</span> <span class="n">scaf</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">scaffold_counts</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">reused_scaffolds</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ScaffoldUsedTwiceError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Scaffolds used 2+ times: </span><span class="si">{</span><span class="n">reused_scaffolds</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">joins</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agp.join.make_superscaffold_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_superscaffold_name</span><span class="p">(</span><span class="n">subscaffold_names</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Comes up with a nice superscaffold name based on the given
subscaffold names. If the subscaffold names are all in the format
'[prefix]<em>[suffix]', where prefix is the same for all subscaffolds,
then the superscaffold name is '[prefix]</em>[suffix1]p[suffix2]p[etc.]'
Otherwise, it's the names of all scaffolds concatenated with 'p'.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>subscaffold_names</code>
            </td>
            <td>
                  <code>list(str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of names of subscaffolds
being combined into a superscaffold</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>superscaffold_name</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a name for the new scaffolds based
on the subscaffold names</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/join.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_superscaffold_name</span><span class="p">(</span><span class="n">subscaffold_names</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Comes up with a nice superscaffold name based on the given</span>
<span class="sd">    subscaffold names. If the subscaffold names are all in the format</span>
<span class="sd">    &#39;[prefix]_[suffix]&#39;, where prefix is the same for all subscaffolds,</span>
<span class="sd">    then the superscaffold name is &#39;[prefix]_[suffix1]p[suffix2]p[etc.]&#39;</span>
<span class="sd">    Otherwise, it&#39;s the names of all scaffolds concatenated with &#39;p&#39;.</span>

<span class="sd">    Args:</span>
<span class="sd">        subscaffold_names (list(str)): list of names of subscaffolds</span>
<span class="sd">            being combined into a superscaffold</span>

<span class="sd">    Returns:</span>
<span class="sd">        superscaffold_name (str): a name for the new scaffolds based</span>
<span class="sd">            on the subscaffold names</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO this casting is necessary but ugly as sin. Find a nicer way</span>
    <span class="n">matches</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">scaffold_regex</span><span class="o">.</span><span class="n">search</span><span class="p">,</span> <span class="n">subscaffold_names</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">matches</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span>
            <span class="n">cast</span><span class="p">(</span><span class="n">Match</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">cast</span><span class="p">(</span><span class="n">Match</span><span class="p">,</span> <span class="n">matches</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">matches</span>
        <span class="p">):</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">Match</span><span class="p">,</span> <span class="n">matches</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">suffix</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">cast</span><span class="p">(</span><span class="n">Match</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">])</span>
            <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;p&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subscaffold_names</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agp.join.run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="n">joins_list</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">agp_infile</span><span class="p">,</span> <span class="n">gap_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">gap_type</span><span class="o">=</span><span class="s1">&#39;scaffold&#39;</span><span class="p">,</span> <span class="n">gap_evidence</span><span class="o">=</span><span class="s1">&#39;na&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Runs the 'join' module of agptools.</p>


            <details class="quote">
              <summary>Source code in <code>agp/join.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span>
    <span class="n">joins_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">JoinGroup</span><span class="p">],</span>
    <span class="n">outfile</span><span class="p">:</span> <span class="n">TextIO</span><span class="p">,</span>
    <span class="n">agp_infile</span><span class="p">:</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">AgpRow</span><span class="p">]],</span>
    <span class="n">gap_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="n">gap_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;scaffold&quot;</span><span class="p">,</span>
    <span class="n">gap_evidence</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;na&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs the &#39;join&#39; module of agptools.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># first, make a dict mapping the names of all scaffolds that will</span>
    <span class="c1"># be modified to an empty list which will later contain all agp rows</span>
    <span class="c1"># of that scaffold.</span>
    <span class="n">scaffolds_to_join</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">AgpRow</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;+-&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">joins_list</span><span class="p">)):</span>
        <span class="n">scaffolds_to_join</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># print all the rows to be output as-is and put the rows that need</span>
    <span class="c1"># to be modified first into the correct slot of the</span>
    <span class="c1"># scaffolds_to_join dict</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">agp_infile</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">AgpRow</span><span class="p">)</span> <span class="ow">and</span> <span class="n">row</span><span class="o">.</span><span class="n">object</span> <span class="ow">in</span> <span class="n">scaffolds_to_join</span><span class="p">:</span>
            <span class="n">scaffolds_to_join</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">object</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">outfile</span><span class="p">)</span>

    <span class="c1"># make sure we found agp entries for all the scaffolds</span>
    <span class="k">for</span> <span class="n">scaffold_name</span><span class="p">,</span> <span class="n">rows</span> <span class="ow">in</span> <span class="n">scaffolds_to_join</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ScaffoldNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Scaffold </span><span class="si">{</span><span class="n">scaffold_name</span><span class="si">}</span><span class="s2"> not found in agp.&quot;</span><span class="p">)</span>

    <span class="c1"># loop through each join group</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">join_group</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">joins_list</span><span class="p">):</span>
        <span class="n">scaffold_rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># loop through the scaffolds in this join group</span>
        <span class="k">for</span> <span class="n">scaffold_name</span> <span class="ow">in</span> <span class="n">join_group</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">scaffold_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">):</span>
                <span class="c1"># reverse-complement if necessary</span>
                <span class="n">scaffold_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">reverse_rows</span><span class="p">(</span><span class="n">scaffolds_to_join</span><span class="p">[</span><span class="n">scaffold_name</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)])</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">scaffold_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scaffolds_to_join</span><span class="p">[</span><span class="n">scaffold_name</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">)])</span>

        <span class="c1"># print out all the rows for this join group</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">join_scaffolds</span><span class="p">(</span>
            <span class="n">scaffold_rows</span><span class="p">,</span> <span class="n">gap_size</span><span class="p">,</span> <span class="n">gap_type</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">join_group</span><span class="o">.</span><span class="n">name</span>
        <span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">outfile</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="agp.remove" class="doc doc-heading">
            <code>agp.remove</code>


</h2>

    <div class="doc doc-contents first">









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="agp.remove.scaffolds_list_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">scaffolds_list_type</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Parse a list of scaffolds</p>
<p>Given a filename pointing to a list of scaffolds, one per line,
parse it and return a list of scaffold strings.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>path to a file containing a list of scaffolds</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Set">Set</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the set of scaffold names in the file</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/remove.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">scaffolds_list_type</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse a list of scaffolds</span>

<span class="sd">    Given a filename pointing to a list of scaffolds, one per line,</span>
<span class="sd">    parse it and return a list of scaffold strings.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename: path to a file containing a list of scaffolds</span>

<span class="sd">    Returns:</span>
<span class="sd">        the set of scaffold names in the file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">scaffolds</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">scaffolds_list_file</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">scaffolds_list_file</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">empty_line_regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
                <span class="n">scaffolds</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">scaffolds</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="agp.rename" class="doc doc-heading">
            <code>agp.rename</code>


</h2>

    <div class="doc doc-contents first">









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="agp.rename.rename_rows" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rename_rows</span><span class="p">(</span><span class="n">rows_to_rename</span><span class="p">,</span> <span class="n">new_name</span><span class="p">,</span> <span class="n">orientation</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Rename a bunch of agp rows</p>
<p>Rename a bunch of agp rows, and possibly reverse them too.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rows_to_rename</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>all of the rows of a scaffold that is being renamed</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>new_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the new name for this scaffold</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>orientation</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>either "+" or "-", the latter if reverse orienting the
scaffold is desired</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the renamed and perhaps reverse oriented rows</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/rename.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rename_rows</span><span class="p">(</span>
    <span class="n">rows_to_rename</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">AgpRow</span><span class="p">],</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">orientation</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">AgpRow</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Rename a bunch of agp rows</span>

<span class="sd">    Rename a bunch of agp rows, and possibly reverse them too.</span>

<span class="sd">    Args:</span>
<span class="sd">        rows_to_rename:</span>
<span class="sd">            all of the rows of a scaffold that is being renamed</span>
<span class="sd">        new_name:</span>
<span class="sd">            the new name for this scaffold</span>
<span class="sd">        orientation:</span>
<span class="sd">            either &quot;+&quot; or &quot;-&quot;, the latter if reverse orienting the</span>
<span class="sd">            scaffold is desired</span>

<span class="sd">    Returns:</span>
<span class="sd">        the renamed and perhaps reverse oriented rows</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows_to_rename</span><span class="p">:</span>
        <span class="n">row</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">new_name</span>
        <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">reverse_rows</span><span class="p">(</span><span class="n">new_rows</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_rows</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agp.rename.renaming_file_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">renaming_file_type</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Parse a renaming file</p>
<p>A renaming file has 2-3 columns:
1. current scaffold name
2. desired new scaffold name
3. orientation (+/-)</p>
<p>Parse one of these files and return it in dictionary format</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>path to renaming file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="tuple">tuple</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the file in dict format: d[old_name] = (new_name, orientation)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/rename.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">renaming_file_type</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse a renaming file</span>

<span class="sd">    A renaming file has 2-3 columns:</span>
<span class="sd">    1. current scaffold name</span>
<span class="sd">    2. desired new scaffold name</span>
<span class="sd">    3. orientation (+/-)</span>

<span class="sd">    Parse one of these files and return it in dictionary format</span>

<span class="sd">    Args:</span>
<span class="sd">        filename: path to renaming file</span>

<span class="sd">    Returns:</span>
<span class="sd">        the file in dict format: d[old_name] = (new_name, orientation)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">renaming_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">renaming_file</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">renaming_file</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">empty_line_regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
                <span class="n">fields</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">FormatError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Line </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> of renaming file doesn&#39;t have enough columns.&quot;</span>
                    <span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># default to + orientation</span>
                    <span class="n">renaming_dict</span><span class="p">[</span><span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;+&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">fields</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">]:</span>
                        <span class="k">raise</span> <span class="n">FormatError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;Line </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: orientation column can only contain + or -&quot;</span>
                        <span class="p">)</span>
                    <span class="n">renaming_dict</span><span class="p">[</span><span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fields</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">renaming_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agp.rename.run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="n">renaming_map</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">agp_rows</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Run the rename module</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>renaming_map</code>
            </td>
            <td>
                  <code><span title="typing.Mapping">Mapping</span>[<span title="str">str</span>, <span title="tuple">tuple</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>maps the name of a contig to be renamed to a tuple
containing the new name and orientation</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>outfile</code>
            </td>
            <td>
                  <code><span title="typing.TextIO">TextIO</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>file where agp output should be sent</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>agp_rows</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>all input AGP rows</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/rename.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span>
    <span class="n">renaming_map</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
    <span class="n">outfile</span><span class="p">:</span> <span class="n">TextIO</span><span class="p">,</span>
    <span class="n">agp_rows</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">AgpRow</span><span class="p">],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run the rename module</span>

<span class="sd">    Args:</span>
<span class="sd">        renaming_map:</span>
<span class="sd">            maps the name of a contig to be renamed to a tuple</span>
<span class="sd">            containing the new name and orientation</span>
<span class="sd">        outfile: file where agp output should be sent</span>
<span class="sd">        agp_rows: all input AGP rows</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rows_to_rename</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AgpRow</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">current_object</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span>  <span class="c1"># can&#39;t use None because dict needs a string</span>
    <span class="n">renamed_objects</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">agp_rows</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">outfile</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">row</span><span class="o">.</span><span class="n">object</span> <span class="ow">in</span> <span class="n">renaming_map</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rows_to_rename</span> <span class="ow">and</span> <span class="n">current_object</span> <span class="o">!=</span> <span class="n">row</span><span class="o">.</span><span class="n">object</span><span class="p">:</span>
                <span class="c1"># we&#39;re on a new scaffold that does need to be renamed,</span>
                <span class="c1"># but we haven&#39;t renamed and printed the last scaffold</span>
                <span class="c1"># yet, so let&#39;s do that first</span>
                <span class="k">for</span> <span class="n">row_to_print</span> <span class="ow">in</span> <span class="n">rename_rows</span><span class="p">(</span>
                    <span class="n">rows_to_rename</span><span class="p">,</span> <span class="o">*</span><span class="n">renaming_map</span><span class="p">[</span><span class="n">current_object</span><span class="p">]</span>
                <span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">row_to_print</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">outfile</span><span class="p">)</span>
                <span class="n">rows_to_rename</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">renamed_objects</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">current_object</span><span class="p">)</span>
            <span class="n">current_object</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">object</span>
            <span class="n">rows_to_rename</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rows_to_rename</span> <span class="ow">and</span> <span class="n">current_object</span> <span class="o">!=</span> <span class="n">row</span><span class="o">.</span><span class="n">object</span><span class="p">:</span>
                <span class="c1"># we&#39;re on a new scaffold that does not need to be</span>
                <span class="c1"># renamed, but the previous scaffold does need to</span>
                <span class="c1"># be renamed, so let&#39;s rename and print it out first</span>
                <span class="k">for</span> <span class="n">row_to_print</span> <span class="ow">in</span> <span class="n">rename_rows</span><span class="p">(</span>
                    <span class="n">rows_to_rename</span><span class="p">,</span> <span class="o">*</span><span class="n">renaming_map</span><span class="p">[</span><span class="n">current_object</span><span class="p">]</span>
                <span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">row_to_print</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">outfile</span><span class="p">)</span>
                <span class="n">rows_to_rename</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">renamed_objects</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">current_object</span><span class="p">)</span>
                <span class="n">current_object</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span>
            <span class="c1"># now we can print the new row</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">outfile</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">rows_to_rename</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">row_to_print</span> <span class="ow">in</span> <span class="n">rename_rows</span><span class="p">(</span><span class="n">rows_to_rename</span><span class="p">,</span> <span class="o">*</span><span class="n">renaming_map</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">object</span><span class="p">]):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">row_to_print</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">outfile</span><span class="p">)</span>
        <span class="n">renamed_objects</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">current_object</span><span class="p">)</span>

    <span class="n">remaining_objects</span> <span class="o">=</span> <span class="n">renaming_map</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">-</span> <span class="n">renamed_objects</span>
    <span class="k">if</span> <span class="n">remaining_objects</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ScaffoldNotFoundError</span><span class="p">(</span><span class="n">remaining_objects</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="agp.split" class="doc doc-heading">
            <code>agp.split</code>


</h2>

    <div class="doc doc-contents first">

        <p>Functions for splitting a scaffold into subscaffolds at gaps.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="agp.split.ParsingError" class="doc doc-heading">
            <code>ParsingError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Raised when breakpoints file is misformatted.</p>







              <details class="quote">
                <summary>Source code in <code>agp/split.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ParsingError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised when breakpoints file is misformatted.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="agp.split.breakpoints_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">breakpoints_type</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Argparse type function for breakpoints file: first column is the
scaffold name; second column is a comma-separated list of
locations within gaps where scaffold should be broken.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>path to the breakpoints file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>breakpoints</code></td>            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.List">List</span>[<span title="int">int</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a dict mapping scaffold name to a list
of breakpoints (int) on that scaffold</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="FileNotFoundError">FileNotFoundError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if <code>filename</code> does not point to readable file</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ParsingError (agp.split.ParsingError)" href="#agp.split.ParsingError">ParsingError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if there is an error in the input file's format or
content</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">breakpoints_type</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Argparse type function for breakpoints file: first column is the</span>
<span class="sd">    scaffold name; second column is a comma-separated list of</span>
<span class="sd">    locations within gaps where scaffold should be broken.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename: path to the breakpoints file</span>

<span class="sd">    Returns:</span>
<span class="sd">        breakpoints: a dict mapping scaffold name to a list</span>
<span class="sd">            of breakpoints (int) on that scaffold</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: if `filename` does not point to readable file</span>
<span class="sd">        ParsingError: if there is an error in the input file&#39;s format or</span>
<span class="sd">            content</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">breakpoints</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">breakpoints_file</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">breakpoints_file</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">empty_line_regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
                <span class="n">splits</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">breakpoints</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">ParsingError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> specified multiple times in breakpoints file&quot;</span>
                        <span class="p">)</span>
                    <span class="n">breakpoints</span><span class="p">[</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">splits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)))</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">ParsingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot parse line </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> of breakpoints: </span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">breakpoints</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agp.split.convert_rows" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_rows</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">subscaffold_counter</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Converts rows that are part of a scaffold into their own standalone
scaffold. Changes the positions and part numbers so that the new
scaffold starts at 1, and names the new scaffold after the old
scaffold, but with '.{subscaffold_counter}' at the end.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rows</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>rows to turn into their own scaffold.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subscaffold_counter</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>suffix to add to the old scaffold
name in order to turn it into the new scaffold name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the input rows, but with object names, positions, and part</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>numbers changed so that they now function as a standalone</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>scaffold</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_rows</span><span class="p">(</span><span class="n">rows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">AgpRow</span><span class="p">],</span> <span class="n">subscaffold_counter</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">AgpRow</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts rows that are part of a scaffold into their own standalone</span>
<span class="sd">    scaffold. Changes the positions and part numbers so that the new</span>
<span class="sd">    scaffold starts at 1, and names the new scaffold after the old</span>
<span class="sd">    scaffold, but with &#39;.{subscaffold_counter}&#39; at the end.</span>

<span class="sd">    Args:</span>
<span class="sd">        rows: rows to turn into their own scaffold.</span>
<span class="sd">        subscaffold_counter: suffix to add to the old scaffold</span>
<span class="sd">            name in order to turn it into the new scaffold name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        the input rows, but with object names, positions, and part</span>
<span class="sd">        numbers changed so that they now function as a standalone</span>
<span class="sd">        scaffold</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_scaffold_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="n">subscaffold_counter</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">unoffset_rows</span><span class="p">(</span><span class="n">new_scaffold_name</span><span class="p">,</span> <span class="n">rows</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agp.split.split_contig" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split_contig</span><span class="p">(</span><span class="n">contig_row</span><span class="p">,</span> <span class="n">breakpoints</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Splits a single row containing a contig into multiple rows,
each containing a piece of the contig.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>contig_row</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a single row to be split</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>breakpoints</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>positions where contig should be split,
in object coordinates, <em>not</em> component coordinates. The left
part of the split includes the breakpoint: e.g., splitting a
contig of length 100 at 43 will make two new contigs: one
from 1-43 and the other from 44-100.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list of rows of length len(breakpoints) + 1, where each row is</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a piece of the contig after splitting. Note that while the new</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>coordinates are correct in the coordinates of the original</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>scaffold they came from, the object coordinates still need to be</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>offset to match the new scaffold they will end up in.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">agp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">agp</span><span class="o">.</span><span class="n">AgpRow</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;scaf&#39;</span><span class="p">,</span> <span class="mi">501</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                   <span class="s1">&#39;ctg&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">])))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">split_contig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="p">[</span><span class="mi">750</span><span class="p">,</span> <span class="mi">867</span><span class="p">])]</span>
<span class="go">[[&#39;scaf&#39;, &#39;501&#39;, &#39;750&#39;, &#39;5&#39;, &#39;W&#39;, &#39;ctg&#39;, &#39;1&#39;, &#39;250&#39;, &#39;+&#39;],</span>
<span class="go"> [&#39;scaf&#39;, &#39;751&#39;, &#39;867&#39;, &#39;6&#39;, &#39;W&#39;, &#39;ctg&#39;, &#39;251&#39;, &#39;367&#39;, &#39;+&#39;],</span>
<span class="go"> [&#39;scaf&#39;, &#39;868&#39;, &#39;1000&#39;, &#39;7&#39;, &#39;W&#39;, &#39;ctg&#39;, &#39;368&#39;, &#39;500&#39;, &#39;+&#39;]]</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>agp/split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">split_contig</span><span class="p">(</span><span class="n">contig_row</span><span class="p">:</span> <span class="n">AgpRow</span><span class="p">,</span> <span class="n">breakpoints</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">AgpRow</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Splits a single row containing a contig into multiple rows,</span>
<span class="sd">    each containing a piece of the contig.</span>

<span class="sd">    Args:</span>
<span class="sd">        contig_row: a single row to be split</span>
<span class="sd">        breakpoints: positions where contig should be split,</span>
<span class="sd">            in object coordinates, *not* component coordinates. The left</span>
<span class="sd">            part of the split includes the breakpoint: e.g., splitting a</span>
<span class="sd">            contig of length 100 at 43 will make two new contigs: one</span>
<span class="sd">            from 1-43 and the other from 44-100.</span>

<span class="sd">    Returns:</span>
<span class="sd">        a list of rows of length len(breakpoints) + 1, where each row is</span>
<span class="sd">        a piece of the contig after splitting. Note that while the new</span>
<span class="sd">        coordinates are correct in the coordinates of the original</span>
<span class="sd">        scaffold they came from, the object coordinates still need to be</span>
<span class="sd">        offset to match the new scaffold they will end up in.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import agp</span>
<span class="sd">        &gt;&gt;&gt; r = agp.AgpRow(&#39;\\t&#39;.join(map(str, [&#39;scaf&#39;, 501, 1000, 5, &#39;W&#39;,</span>
<span class="sd">        ...                                    &#39;ctg&#39;, 1, 500, &#39;+&#39;])))</span>
<span class="sd">        &gt;&gt;&gt; [str(x).split(&#39;\\t&#39;) for x in split_contig(r, [750, 867])]</span>
<span class="sd">        [[&#39;scaf&#39;, &#39;501&#39;, &#39;750&#39;, &#39;5&#39;, &#39;W&#39;, &#39;ctg&#39;, &#39;1&#39;, &#39;250&#39;, &#39;+&#39;],</span>
<span class="sd">         [&#39;scaf&#39;, &#39;751&#39;, &#39;867&#39;, &#39;6&#39;, &#39;W&#39;, &#39;ctg&#39;, &#39;251&#39;, &#39;367&#39;, &#39;+&#39;],</span>
<span class="sd">         [&#39;scaf&#39;, &#39;868&#39;, &#39;1000&#39;, &#39;7&#39;, &#39;W&#39;, &#39;ctg&#39;, &#39;368&#39;, &#39;500&#39;, &#39;+&#39;]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="n">contig_row</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">this_breakpoint</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">breakpoints</span><span class="p">):</span>
        <span class="n">left_part</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">rows</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
        <span class="n">right_part</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">left_part</span><span class="p">)</span>

        <span class="n">left_part</span><span class="o">.</span><span class="n">object_end</span> <span class="o">=</span> <span class="n">this_breakpoint</span>
        <span class="n">right_part</span><span class="o">.</span><span class="n">object_beg</span> <span class="o">=</span> <span class="n">this_breakpoint</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">right_part</span><span class="o">.</span><span class="n">part_number</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">contig_row</span><span class="o">.</span><span class="n">orientation</span> <span class="o">==</span> <span class="s2">&quot;+&quot;</span><span class="p">:</span>
            <span class="n">left_part</span><span class="o">.</span><span class="n">component_end</span> <span class="o">=</span> <span class="n">left_part</span><span class="o">.</span><span class="n">component_beg</span> <span class="o">+</span> <span class="p">(</span>
                <span class="n">this_breakpoint</span> <span class="o">-</span> <span class="n">left_part</span><span class="o">.</span><span class="n">object_beg</span>
            <span class="p">)</span>
            <span class="n">right_part</span><span class="o">.</span><span class="n">component_beg</span> <span class="o">=</span> <span class="n">left_part</span><span class="o">.</span><span class="n">component_end</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">left_part</span><span class="o">.</span><span class="n">component_beg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">left_part</span><span class="o">.</span><span class="n">object_beg</span> <span class="o">+</span> <span class="n">left_part</span><span class="o">.</span><span class="n">component_end</span> <span class="o">-</span> <span class="n">this_breakpoint</span>
            <span class="p">)</span>
            <span class="n">right_part</span><span class="o">.</span><span class="n">component_end</span> <span class="o">=</span> <span class="n">left_part</span><span class="o">.</span><span class="n">component_beg</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="n">rows</span> <span class="o">+=</span> <span class="p">[</span><span class="n">left_part</span><span class="p">,</span> <span class="n">right_part</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">rows</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agp.split.split_scaffold" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split_scaffold</span><span class="p">(</span><span class="n">scaffold_rows</span><span class="p">,</span> <span class="n">breakpoints</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Splits a scaffold at specified breakpoints.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>scaffold_rows</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>all the rows for a given scaffold in an AGP file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>breakpoints</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list of locations where scaffold should be
broken. All locations are specified in genomic coordinates
and must be within the boundaries of a gap.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>broken_rows</code></td>            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>rows of the input scaffold broken
into len(breakpoints)+1 sub-scaffolds, with the gaps
containing the breakpoints removed</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">split_scaffold</span><span class="p">(</span>
    <span class="n">scaffold_rows</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">AgpRow</span><span class="p">],</span> <span class="n">breakpoints</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">AgpRow</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Splits a scaffold at specified breakpoints.</span>

<span class="sd">    Args:</span>
<span class="sd">        scaffold_rows: all the rows for a given scaffold in an AGP file</span>
<span class="sd">        breakpoints: a list of locations where scaffold should be</span>
<span class="sd">            broken. All locations are specified in genomic coordinates</span>
<span class="sd">            and must be within the boundaries of a gap.</span>

<span class="sd">    Returns:</span>
<span class="sd">        broken_rows: rows of the input scaffold broken</span>
<span class="sd">            into len(breakpoints)+1 sub-scaffolds, with the gaps</span>
<span class="sd">            containing the breakpoints removed</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">out_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">rows_this_subscaffold</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">AgpRow</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">subscaffold_counter</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">scaffold_rows</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">contains</span><span class="p">,</span> <span class="n">breakpoints</span><span class="p">)):</span>
            <span class="c1"># if the breakpoint is within a gap, our job is simple:</span>
            <span class="c1"># just forget about the gap row, output the previous</span>
            <span class="c1"># subscaffold, and start a new subscaffold</span>
            <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">is_gap</span><span class="p">:</span>
                <span class="n">out_rows</span> <span class="o">+=</span> <span class="n">convert_rows</span><span class="p">(</span><span class="n">rows_this_subscaffold</span><span class="p">,</span> <span class="n">subscaffold_counter</span><span class="p">)</span>

                <span class="n">rows_this_subscaffold</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">subscaffold_counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="c1"># if the breakpoint is not within a gap, we need to actually</span>
            <span class="c1"># break a contig into pieces</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># split the contig into two or more rows</span>
                <span class="n">contig_rows</span> <span class="o">=</span> <span class="n">split_contig</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">contains</span><span class="p">,</span> <span class="n">breakpoints</span><span class="p">)))</span>

                <span class="c1"># the first row goes at the end of the current scaffold</span>
                <span class="n">rows_this_subscaffold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contig_rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">del</span> <span class="n">contig_rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">out_rows</span> <span class="o">+=</span> <span class="n">convert_rows</span><span class="p">(</span><span class="n">rows_this_subscaffold</span><span class="p">,</span> <span class="n">subscaffold_counter</span><span class="p">)</span>
                <span class="n">subscaffold_counter</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="c1"># the last row goes at the beginning of the next</span>
                <span class="c1"># scaffold</span>
                <span class="n">rows_this_subscaffold</span> <span class="o">=</span> <span class="p">[</span><span class="n">contig_rows</span><span class="o">.</span><span class="n">pop</span><span class="p">()]</span>

                <span class="c1"># if there are any rows in between, they each get their</span>
                <span class="c1"># own subscaffold</span>
                <span class="k">for</span> <span class="n">contig_part</span> <span class="ow">in</span> <span class="n">contig_rows</span><span class="p">:</span>
                    <span class="n">out_rows</span> <span class="o">+=</span> <span class="n">convert_rows</span><span class="p">([</span><span class="n">contig_part</span><span class="p">],</span> <span class="n">subscaffold_counter</span><span class="p">)</span>
                    <span class="n">subscaffold_counter</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">else</span><span class="p">:</span>  <span class="c1"># only add this row if there are no breakpoints in it</span>
            <span class="n">rows_this_subscaffold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

    <span class="n">out_rows</span> <span class="o">+=</span> <span class="n">convert_rows</span><span class="p">(</span><span class="n">rows_this_subscaffold</span><span class="p">,</span> <span class="n">subscaffold_counter</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">out_rows</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agp.split.unoffset_rows" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unoffset_rows</span><span class="p">(</span><span class="n">new_scaffold_name</span><span class="p">,</span> <span class="n">rows</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Modifies some AGP rows so that they can be their own standalone
scaffold. This requires changing their object names to a new
scaffold name, and changing the part numbers and coordinates such
that the first row starts with 1 and the rest follow.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>new_scaffold_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>name for the new scaffold which will
replace all 'object' fields</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rows</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>rows to modify so that they function as a
standalone scaffold together. The first row will be used to
calculate offsets.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>out_rows</code></td>            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>input rows, but with all 'object'
fields replaced with new_scaffold_name, and all positions
and part numbers modified so that the first row is the
beginning of a new scaffold.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">unoffset_rows</span><span class="p">(</span><span class="n">new_scaffold_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">rows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">AgpRow</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">AgpRow</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modifies some AGP rows so that they can be their own standalone</span>
<span class="sd">    scaffold. This requires changing their object names to a new</span>
<span class="sd">    scaffold name, and changing the part numbers and coordinates such</span>
<span class="sd">    that the first row starts with 1 and the rest follow.</span>

<span class="sd">    Args:</span>
<span class="sd">        new_scaffold_name: name for the new scaffold which will</span>
<span class="sd">            replace all &#39;object&#39; fields</span>
<span class="sd">        rows: rows to modify so that they function as a</span>
<span class="sd">            standalone scaffold together. The first row will be used to</span>
<span class="sd">            calculate offsets.</span>

<span class="sd">    Returns:</span>
<span class="sd">        out_rows: input rows, but with all &#39;object&#39;</span>
<span class="sd">            fields replaced with new_scaffold_name, and all positions</span>
<span class="sd">            and part numbers modified so that the first row is the</span>
<span class="sd">            beginning of a new scaffold.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">position_offset</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">object_beg</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">out_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
        <span class="n">row</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">new_scaffold_name</span>
        <span class="n">row</span><span class="o">.</span><span class="n">object_beg</span> <span class="o">-=</span> <span class="n">position_offset</span>
        <span class="n">row</span><span class="o">.</span><span class="n">object_end</span> <span class="o">-=</span> <span class="n">position_offset</span>
        <span class="n">row</span><span class="o">.</span><span class="n">part_number</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">out_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out_rows</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="agp.transform" class="doc doc-heading">
            <code>agp.transform</code>


</h2>

    <div class="doc doc-contents first">

        <p>Functions for transforming genomic coordinates from contig-based to
scaffold-based.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="agp.transform.BadOrientationError" class="doc doc-heading">
            <code>BadOrientationError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Error for bad orientation (not +/-)</p>







              <details class="quote">
                <summary>Source code in <code>agp/transform.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BadOrientationError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Error for bad orientation (not +/-)&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agp.transform.CoordinateNotFoundError" class="doc doc-heading">
            <code>CoordinateNotFoundError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Error for bad coordinates specified</p>







              <details class="quote">
                <summary>Source code in <code>agp/transform.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CoordinateNotFoundError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Error for bad coordinates specified&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agp.transform.UnsupportedOperationError" class="doc doc-heading">
            <code>UnsupportedOperationError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Error for trying to transform an unsupported style of bed row</p>







              <details class="quote">
                <summary>Source code in <code>agp/transform.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">UnsupportedOperationError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Error for trying to transform an unsupported style of bed row&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="agp.transform.create_contig_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_contig_dict</span><span class="p">(</span><span class="n">agp_in</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Load the agp file into a dictionary mapping contig name to a list
of rows in which that contig is the component_id.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>agp_in</code>
            </td>
            <td>
                  <code><span title="typing.Iterator">Iterator</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>an agp file to read into a dictionary</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="agp.transform.ContigDict">ContigDict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a dict mapping contig name to a list of rows in which that</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="agp.transform.ContigDict">ContigDict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>contig is the component_id</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/transform.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_contig_dict</span><span class="p">(</span><span class="n">agp_in</span><span class="p">:</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">AgpRow</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">ContigDict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load the agp file into a dictionary mapping contig name to a list</span>
<span class="sd">    of rows in which that contig is the component_id.</span>

<span class="sd">    Args:</span>
<span class="sd">        agp_in: an agp file to read into a dictionary</span>

<span class="sd">    Returns:</span>
<span class="sd">        a dict mapping contig name to a list of rows in which that</span>
<span class="sd">        contig is the component_id</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">contig_dict</span><span class="p">:</span> <span class="n">ContigDict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="p">(</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">agp_in</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">AgpRow</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">r</span><span class="o">.</span><span class="n">is_gap</span><span class="p">):</span>
        <span class="n">contig_dict</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">component_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">contig_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agp.transform.find_agp_row" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_agp_row</span><span class="p">(</span><span class="n">contig_name</span><span class="p">,</span> <span class="n">coordinate_on_contig</span><span class="p">,</span> <span class="n">contig_dict</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Find the agp row containing a coordinate.</p>
<p>Given a dictionary mapping contig name to a list of agp rows
containing that contig, and a single position in contig coordinates,
find and return the AGP row containing that position.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>contig_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the contig containing the coordinate</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>coordinate_on_contig</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the position to look for, in contig coordinates</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>contig_dict</code>
            </td>
            <td>
                  <code><span title="agp.transform.ContigDict">ContigDict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a dictionary mapping contig name to a list of agp rows
containing that contig</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a single AGP row containing the requested position</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/transform.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_agp_row</span><span class="p">(</span>
    <span class="n">contig_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">coordinate_on_contig</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">contig_dict</span><span class="p">:</span> <span class="n">ContigDict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AgpRow</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find the agp row containing a coordinate.</span>

<span class="sd">    Given a dictionary mapping contig name to a list of agp rows</span>
<span class="sd">    containing that contig, and a single position in contig coordinates,</span>
<span class="sd">    find and return the AGP row containing that position.</span>

<span class="sd">    Args:</span>
<span class="sd">        contig_name:</span>
<span class="sd">            the contig containing the coordinate</span>
<span class="sd">        coordinate_on_contig:</span>
<span class="sd">            the position to look for, in contig coordinates</span>
<span class="sd">        contig_dict:</span>
<span class="sd">            a dictionary mapping contig name to a list of agp rows</span>
<span class="sd">            containing that contig</span>

<span class="sd">    Returns:</span>
<span class="sd">        a single AGP row containing the requested position</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">contig_list</span> <span class="o">=</span> <span class="n">contig_dict</span><span class="p">[</span><span class="n">contig_name</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">contig_list</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NoSuchContigError</span><span class="p">(</span><span class="n">contig_name</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">agp_row</span> <span class="ow">in</span> <span class="n">contig_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">agp_row</span><span class="o">.</span><span class="n">component_beg</span> <span class="o">&lt;=</span> <span class="n">coordinate_on_contig</span>
            <span class="ow">and</span> <span class="n">agp_row</span><span class="o">.</span><span class="n">component_end</span> <span class="o">&gt;=</span> <span class="n">coordinate_on_contig</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="n">agp_row</span>

    <span class="k">raise</span> <span class="n">CoordinateNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">contig_name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">coordinate_on_contig</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agp.transform.transform_bed_row" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">transform_bed_row</span><span class="p">(</span><span class="n">bed_row</span><span class="p">,</span> <span class="n">contig_dict</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Transform a bed row to scaffold coordinates</p>
<p>Transform a single row of a bed file from contig coordinates to
scaffold coordinates.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>bed_row</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="BedRange


  
      dataclass
   (agp.bed.BedRange)" href="#agp.bed.BedRange">BedRange</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the row to transform</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>contig_dict</code>
            </td>
            <td>
                  <code><span title="agp.transform.ContigDict">ContigDict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a dictionary mapping contig name to the agp row(s)
containing that contig</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="BedRange


  
      dataclass
   (agp.bed.BedRange)" href="#agp.bed.BedRange">BedRange</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the same bed row, but in scaffold coordinates now</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/transform.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">transform_bed_row</span><span class="p">(</span><span class="n">bed_row</span><span class="p">:</span> <span class="n">BedRange</span><span class="p">,</span> <span class="n">contig_dict</span><span class="p">:</span> <span class="n">ContigDict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BedRange</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transform a bed row to scaffold coordinates</span>

<span class="sd">    Transform a single row of a bed file from contig coordinates to</span>
<span class="sd">    scaffold coordinates.</span>

<span class="sd">    Args:</span>
<span class="sd">        bed_row: the row to transform</span>
<span class="sd">        contig_dict:</span>
<span class="sd">            a dictionary mapping contig name to the agp row(s)</span>
<span class="sd">            containing that contig</span>

<span class="sd">    Returns:</span>
<span class="sd">        the same bed row, but in scaffold coordinates now</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bed_row</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">bed_row</span><span class="o">.</span><span class="n">end</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">UnsupportedOperationError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Transforming coordinateless bed row: </span><span class="si">{</span><span class="n">bed_row</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="c1"># retrieve the AGP rows containing the bed range&#39;s start and end points</span>
    <span class="n">agp_row_start</span> <span class="o">=</span> <span class="n">find_agp_row</span><span class="p">(</span><span class="n">bed_row</span><span class="o">.</span><span class="n">chrom</span><span class="p">,</span> <span class="n">bed_row</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">contig_dict</span><span class="p">)</span>
    <span class="n">agp_row_end</span> <span class="o">=</span> <span class="n">find_agp_row</span><span class="p">(</span><span class="n">bed_row</span><span class="o">.</span><span class="n">chrom</span><span class="p">,</span> <span class="n">bed_row</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">contig_dict</span><span class="p">)</span>

    <span class="c1"># only transform bed ranges that are entirely within one scaffold</span>
    <span class="k">if</span> <span class="n">agp_row_start</span><span class="o">.</span><span class="n">object</span> <span class="o">==</span> <span class="n">agp_row_end</span><span class="o">.</span><span class="n">object</span><span class="p">:</span>
        <span class="n">bed_row</span><span class="o">.</span><span class="n">chrom</span> <span class="o">=</span> <span class="n">agp_row_start</span><span class="o">.</span><span class="n">object</span>
        <span class="c1"># transform the start and end positions of the bed range to the</span>
        <span class="c1"># new coordinate system</span>
        <span class="n">bed_row</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">bed_row</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">transform_single_position</span><span class="p">(</span><span class="n">bed_row</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">agp_row_start</span><span class="p">),</span>
                <span class="n">transform_single_position</span><span class="p">(</span><span class="n">bed_row</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">agp_row_end</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="c1"># flip the orientation of the bed row, if necessary</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">agp_row_start</span> <span class="o">==</span> <span class="n">agp_row_end</span>
            <span class="ow">and</span> <span class="n">bed_row</span><span class="o">.</span><span class="n">strand</span>
            <span class="ow">and</span> <span class="n">agp_row_start</span><span class="o">.</span><span class="n">orientation</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="n">bed_row</span><span class="o">.</span><span class="n">strand</span> <span class="o">==</span> <span class="s2">&quot;+&quot;</span><span class="p">:</span>
                <span class="n">bed_row</span><span class="o">.</span><span class="n">strand</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bed_row</span><span class="o">.</span><span class="n">strand</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">UnsupportedOperationError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Transforming bed row spanning multiple scaffolds: </span><span class="si">{</span><span class="n">bed_row</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">bed_row</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agp.transform.transform_single_position" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">transform_single_position</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">agp_row</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Transform a position from component to object coordinates</p>
<p>Given a position in component coordinates (e.g., a position on a
contig), and the agp row containing that position, transform the
position to object coordinates (e.g., the same position, but on
a scaffold of which that contig is a part).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>position</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a position in component/contig coordinates</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>agp_row</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="AgpRow (agp.AgpRow)" href="#agp.AgpRow">AgpRow</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the row containing that position</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the same position, but in object/scaffold coordinates</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>agp/transform.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">transform_single_position</span><span class="p">(</span><span class="n">position</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">agp_row</span><span class="p">:</span> <span class="n">AgpRow</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transform a position from component to object coordinates</span>

<span class="sd">    Given a position in component coordinates (e.g., a position on a</span>
<span class="sd">    contig), and the agp row containing that position, transform the</span>
<span class="sd">    position to object coordinates (e.g., the same position, but on</span>
<span class="sd">    a scaffold of which that contig is a part).</span>

<span class="sd">    Args:</span>
<span class="sd">        position: a position in component/contig coordinates</span>
<span class="sd">        agp_row: the row containing that position</span>

<span class="sd">    Returns:</span>
<span class="sd">        the same position, but in object/scaffold coordinates</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># first, offset the position by where it is on this _row_. This</span>
    <span class="c1"># is necessary because not all rows contain an entire component/</span>
    <span class="c1"># contig. E.g., if this row contains positions 101-200 on the</span>
    <span class="c1"># contig, then position 150 on the contig is the 50th base in</span>
    <span class="c1"># the piece of the contig enclosed by this row</span>
    <span class="n">position</span> <span class="o">=</span> <span class="n">position</span> <span class="o">-</span> <span class="n">agp_row</span><span class="o">.</span><span class="n">component_beg</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">agp_row</span><span class="o">.</span><span class="n">orientation</span> <span class="o">==</span> <span class="s2">&quot;+&quot;</span><span class="p">:</span>
        <span class="c1"># then, offset the position by where the row is on the object/</span>
        <span class="c1"># scaffold</span>
        <span class="n">position</span> <span class="o">+=</span> <span class="n">agp_row</span><span class="o">.</span><span class="n">object_beg</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">agp_row</span><span class="o">.</span><span class="n">orientation</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>
        <span class="n">position</span> <span class="o">=</span> <span class="n">agp_row</span><span class="o">.</span><span class="n">object_end</span> <span class="o">-</span> <span class="n">position</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">BadOrientationError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Orientation must be +/-: </span><span class="si">{</span><span class="n">agp_row</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">position</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>