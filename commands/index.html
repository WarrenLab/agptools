
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../api/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>Commands - agptools</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#agptools-commands" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="agptools" class="md-header__button md-logo" aria-label="agptools" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            agptools
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Commands
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="agptools" class="md-nav__button md-logo" aria-label="agptools" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    agptools
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Commands
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Commands
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example-agp" class="md-nav__link">
    <span class="md-ellipsis">
      Example AGP
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flip" class="md-nav__link">
    <span class="md-ellipsis">
      flip
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#split" class="md-nav__link">
    <span class="md-ellipsis">
      split
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#join" class="md-nav__link">
    <span class="md-ellipsis">
      join
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#assemble" class="md-nav__link">
    <span class="md-ellipsis">
      assemble
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remove" class="md-nav__link">
    <span class="md-ellipsis">
      remove
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rename" class="md-nav__link">
    <span class="md-ellipsis">
      rename
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transform" class="md-nav__link">
    <span class="md-ellipsis">
      transform
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API reference
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example-agp" class="md-nav__link">
    <span class="md-ellipsis">
      Example AGP
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flip" class="md-nav__link">
    <span class="md-ellipsis">
      flip
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#split" class="md-nav__link">
    <span class="md-ellipsis">
      split
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#join" class="md-nav__link">
    <span class="md-ellipsis">
      join
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#assemble" class="md-nav__link">
    <span class="md-ellipsis">
      assemble
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remove" class="md-nav__link">
    <span class="md-ellipsis">
      remove
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rename" class="md-nav__link">
    <span class="md-ellipsis">
      rename
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transform" class="md-nav__link">
    <span class="md-ellipsis">
      transform
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="agptools-commands">agptools commands</h1>
<p>agptools's command-line interface consists of several sub-commands, in the
style of, e.g., samtools or git. Here we document each of the commands
including an example of their usage.</p>
<h2 id="example-agp">Example AGP</h2>
<p>Here is an example input AGP file that will be used to demonstrate the usage
of the modules in the following sections:</p>
<pre><code>scaffold_16  1         1096465   1   W  tig00005080 1    1096465 -
scaffold_16  1096466   1096965   2   N  500     scaffold        yes  na
scaffold_16  1096966   1973201   3   W  tig00001012 1    876236  +
scaffold_16  1973202   1973701   4   N  500     scaffold        yes  na
scaffold_16  1973702   4258994   5   W  tig00182876 1    2285293 -
scaffold_16  4258995   4259494   6   N  500     scaffold        yes  na
scaffold_16  4259495   11764263  7   W  tig00000113 1    7504769 +
scaffold_16  11764264  11764763  8   N  500     scaffold        yes  na
scaffold_16  11764764  13768005  9   W  tig00004962 1    2003242 -
scaffold_16  13768006  13768505  10  N  500     scaffold        yes  na
scaffold_16  13768506  17994060  11  W  tig00004933 1    4225555 -
scaffold_16  17994061  17994560  12  N  500     scaffold        yes  na
scaffold_16  17994561  21066363  13  W  tig00000080 1    3071803 -
scaffold_16  21066364  21066863  14  N  500     scaffold        yes  na
scaffold_16  21066864  21807834  15  W  tig00183148 1    740971  +
</code></pre>
<p>It contains eight contigs (and seven gaps, naturally).</p>
<h2 id="flip">flip</h2>
<p>The flip command reverse complements a segment of a scaffold. The use case for
this is the scaffolder putting piece of a scaffold in the wrong orientation.</p>
<p>The required arguments for the flip command are a list of flips to make and the
input agp you want to modify. The list of flips has three columns:
1. The name of the scaffold you want to flip a piece of
2. The beginning position in base pairs, in scaffold coordinates, of the piece
   you want to flip.
3. The end position in base pairs, in scaffold coordinates, of the piece you
   want to flip.</p>
<p>Both coordinates are in the usual DNA range format (i.e., "1-100" takes
everything from the first base of the sequence to the 100th base of the
sequence, including the first and 100th base). The begin coordinate must be
at the beginning of a component and the end coordinate must be at the end of
a component. To do something more complicated, like reverse complement only
part of a contig, use the split and join modules instead.</p>
<p>Here is an example flips file:</p>
<pre><code>scaffold_16   1        1973201
scaffold_16   11764764 21066363
</code></pre>
<p>Here is the command you would use to perform these flips on the example file
shown in the introduction:</p>
<pre><code class="language-bash">agptools flip flips.tsv test_in.agp &gt; test_flip.agp
</code></pre>
<p>And here is the output:</p>
<pre><code>scaffold_16  1         876236    1    W   tig00001012 1    876236      -
scaffold_16  876237    876736    2    N   500     scaffold        yes     na
scaffold_16  876737    1973201   3    W   tig00005080 1    1096465     +
scaffold_16  1973202   1973701   4    N   500     scaffold        yes     na
scaffold_16  1973702   4258994   5    W   tig00182876 1    2285293     -
scaffold_16  4258995   4259494   6    N   500     scaffold        yes     na
scaffold_16  4259495   11764263  7    W   tig00000113 1    7504769     +
scaffold_16  11764264  11764763  8    N   500     scaffold        yes     na
scaffold_16  11764764  14836566  9    W   tig00000080 1    3071803     +
scaffold_16  14836567  14837066  10   N   500     scaffold        yes     na
scaffold_16  14837067  19062621  11   W   tig00004933 1    4225555     +
scaffold_16  19062622  19063121  12   N   500     scaffold        yes     na
scaffold_16  19063122  21066363  13   W   tig00004962 1    2003242     +
scaffold_16  21066364  21066863  14   N   500     scaffold        yes     na
scaffold_16  21066864  21807834  15   W   tig00183148 1    740971      +
</code></pre>
<h2 id="split">split</h2>
<p>The split module breaks a scaffold into multiple scaffolds. There are two
common cases where this operation may be necessary:
1. The scaffolder (or even contig assembler) joined two sequences together that
   aren't actually on the same chromosome.
2. The scaffolder joined two sequences together that are in fact on the same
   chromosome, but it did it in the wrong order, so you want to split the
   scaffold up into pieces and then put the pieces back together in a different
   order later with the <code>join</code> module.</p>
<p>The two required inputs to the split module are the AGP you want to operate on
and a list of splits you want to make. The output is the edited AGP file. The
format of the list of splits is a tab-separated file with the following
columns:
1. Name of the scaffold you want to split into parts
2. A comma-separated list of breakpoint coordinates where you want to break the
   scaffold</p>
<p>Let's say you want to split the example AGP into three pieces: one containing
the first three contigs, one containing the next four, and one containing the
last contig. Here is what the relevant line of your splits file would look
like:</p>
<pre><code>scaffold_16  4258995,21066364
</code></pre>
<p>Note that I used the BEGIN coordinate of the gaps, but you can use any
coordinate inside the gap and it will have the same result.</p>
<p>Here is the command:</p>
<pre><code>agptools split splits.txt test.agp &gt; split_out.agp
</code></pre>
<p>Here is the output:</p>
<pre><code>scaffold_16.1   1        1096465    1   W   tig00005080  1  1096465 -
scaffold_16.1   1096466  1096965    2   N   500 scaffold    yes na
scaffold_16.1   1096966  1973201    3   W   tig00001012  1  876236  +
scaffold_16.1   1973202  1973701    4   N   500 scaffold    yes na
scaffold_16.1   1973702  4258994    5   W   tig00182876  1  2285293 -
scaffold_16.2   1        7504769    1   W   tig00000113  1  7504769 +
scaffold_16.2   7504770  7505269    2   N   500 scaffold    yes na
scaffold_16.2   7505270  9508511    3   W   tig00004962  1  2003242 -
scaffold_16.2   9508512  9509011    4   N   500 scaffold    yes na
scaffold_16.2   9509012  13734566   5   W   tig00004933  1  4225555 -
scaffold_16.2   1373456  13735066   6   N   500 scaffold    yes na
scaffold_16.2   13735067 16806869   7   W   tig00000080  1  3071803 -
scaffold_16.3   1        740971     1   W   tig00183148  1  740971  +
</code></pre>
<h2 id="join">join</h2>
<p>The join module is for taking two different scaffolds and joining them into one
scaffold. Common use-cases for this include:
* The scaffolder failed to join two contigs that belong together
* You want to split up the pieces of a scaffold and put them back together
  again in a different order</p>
<p>The two required arguments for this module are a file specifying what joins
you want to make, and the AGP file you want to modify. The joins list contains
one join per line. Each line is a comma-separated list of scaffolds you want
to put together in the correct order. You can prefix the name of a scaffold with
'+' or '-' to specify its orientation; scaffolds with no orientation specified
are '+' by default.</p>
<p>You can also change the default size, type, and evidence of the newly created
gaps with command-line arguments. See help message for details.</p>
<p>Here is an example joins file:</p>
<pre><code>scaffold_16.2,-scaffold_16.3,+scaffold_16.1
</code></pre>
<p>Here is an example command:</p>
<pre><code class="language-bash">agptools join joins.txt split_out.agp &gt; join_out.agp
</code></pre>
<p>And here is the output of that command:</p>
<pre><code>scaffold_16.2p16.3p16.1 1        7504769    1   W   tig00000113 1   7504769 +
scaffold_16.2p16.3p16.1 7504770  7505269    2   N   500 scaffold    yes na
scaffold_16.2p16.3p16.1 7505270  9508511    3   W   tig00004962 1   2003242 -
scaffold_16.2p16.3p16.1 9508512  9509011    4   N   500 scaffold    yes na
scaffold_16.2p16.3p16.1 9509012  1373456    5   W   tig00004933 1   4225555 -
scaffold_16.2p16.3p16.1 13734567 1373506    6   N   500 scaffold    yes na
scaffold_16.2p16.3p16.1 13735067 1680686    7   W   tig00000080 1   3071803 -
scaffold_16.2p16.3p16.1 16806870 1680736    8   N   500 scaffold    yes na
scaffold_16.2p16.3p16.1 16807370 1754834    9   W   tig00183148 1   740971 -
scaffold_16.2p16.3p16.1 17548341 1754884    1   N   500 scaffold    yes na
scaffold_16.2p16.3p16.1 17548841 1864530    1   W   tig00005080 1   1096465 -
scaffold_16.2p16.3p16.1 18645306 1864580    1   N   500 scaffold    yes na
scaffold_16.2p16.3p16.1 18645806 1952204    1   W   tig00001012 1   876236 +
scaffold_16.2p16.3p16.1 19522042 1952254    1   N   500 scaffold    yes na
scaffold_16.2p16.3p16.1 19522542 2180783    1   W   tig00182876 1   2285293 -
</code></pre>
<p>You can also specify a new name to use instead of the "16.2p16.3p16.1" scheme.
Add a column to the joins file after a tab giving the new name. For example,</p>
<pre><code>scaffold_16.2,-scaffold_16.3,+scaffold_16.1       chr1
</code></pre>
<p>will result in</p>
<pre><code>chr1   1        7504769    1   W   tig00000113 1   7504769 +
chr1   7504770  7505269    2   N   500 scaffold    yes na
chr1   7505270  9508511    3   W   tig00004962 1   2003242 -
chr1   9508512  9509011    4   N   500 scaffold    yes na
chr1   9509012  1373456    5   W   tig00004933 1   4225555 -
chr1   13734567 1373506    6   N   500 scaffold    yes na
chr1   13735067 1680686    7   W   tig00000080 1   3071803 -
chr1   16806870 1680736    8   N   500 scaffold    yes na
chr1   16807370 1754834    9   W   tig00183148 1   740971 -
chr1   17548341 1754884    1   N   500 scaffold    yes na
chr1   17548841 1864530    1   W   tig00005080 1   1096465 -
chr1   18645306 1864580    1   N   500 scaffold    yes na
chr1   18645806 1952204    1   W   tig00001012 1   876236 +
chr1   19522042 1952254    1   N   500 scaffold    yes na
chr1   19522542 2180783    1   W   tig00182876 1   2285293 -
</code></pre>
<h2 id="assemble">assemble</h2>
<p>Once you've got your <em>final</em> final agp, you probably want to create a fasta of
these nice new corrected scaffolds. The <code>assemble</code> module takes a fasta file
containing the original contigs and an agp of how you want to assemble these
contigs into scaffolds, and outputs a fasta of the assembled scaffolds. For
example,</p>
<pre><code class="language-bash">agptools assemble contigs.fa corrected_scaffolds.agp &gt; corrected_scaffolds.fa
</code></pre>
<p>Please note that if using SALSA as your scaffolder, it makes some breaks to
input contigs based on the Hi-C data, and then gives the pieces different names
(e.g., "contig1" to "contig1_1" and "contig1_2"), so you should use the fasta
containing broken contigs as the contigs argument to <code>assemble</code> rather than the
actual original contigs you started out with. This file is called
<code>assembly.clean.fasta</code> and lives in the same directory as the rest of the SALSA
output.</p>
<h2 id="remove">remove</h2>
<p>You may want to get rid of some scaffolds because they contain contamination,
duplication, or something else. The remove module can help with that. Just
give it a list of scaffolds you don't want in the final assembly and it will
remove them. The list of scaffolds to remove should have one scaffold per line,
e.g.,</p>
<pre><code>scaffold_5
scaffold_7
</code></pre>
<p>Running this command:</p>
<pre><code class="language-bash">agptools remove scaffolds_to_remove.txt scaffolds.agp &gt; corrected_scaffolds.agp
</code></pre>
<p>would output <code>scaffolds.agp</code> but with all lines corresponding to <code>scaffolds_5</code>
and <code>scaffolds_7</code> removed.</p>
<h2 id="rename">rename</h2>
<p>Often, you end up with scaffolds that correspond to whole chromosomes, and you
want to therefore give them names befitting chromosomes. The input file for
this command has two required columns and an optional third one:</p>
<ol>
<li>Current name of scaffold</li>
<li>New name of scaffold</li>
<li>Orientation, either <code>+</code> or <code>-</code> (optional). If this column is <code>-</code>, the new
   scaffold will be reverse-oriented compared to the input. If this column is
   left blank, the new scaffold will be exactly the same as the old one, just
   with a different name.</li>
</ol>
<h2 id="transform">transform</h2>
<p>You may have bed files of alignments or annotations where the coordinates are
given in reference to the original contigs, but you want those coordinates
transformed to your new scaffolds. This module makes those transformations.
For example, if you had this bed file:</p>
<pre><code>tig00005080   10952    10960
tig00004962   1        2003242
</code></pre>
<p>and wanted to convert it to scaffold coordinates, you would run the command:</p>
<pre><code class="language-bash">agptools transform contig_coordinates.bed example.agp &gt; scaffold_coordinates.bed
</code></pre>
<p>and the output would be</p>
<pre><code>scaffold_16   10952     10960
scaffold_16   11764764  13768005
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>